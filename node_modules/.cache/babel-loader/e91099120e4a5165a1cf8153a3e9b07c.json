{"ast":null,"code":"import{DefaultSanctionMessageComposer,ModAlertMessageComposer,ModBanMessageComposer,ModKickMessageComposer,ModMessageMessageComposer,ModMuteMessageComposer,ModTradingLockMessageComposer}from'@nitrots/nitro-renderer';import{useMemo,useState}from'react';import{LocalizeText,NotificationAlertType,NotificationUtilities,SendMessageComposer}from'../../../../api';import{Button,Column,DraggableWindowPosition,Flex,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../../common';import{ModActionDefinition}from'../../common/ModActionDefinition';import{useModToolsContext}from'../../ModToolsContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const MOD_ACTION_DEFINITIONS=[new ModActionDefinition(1,'Alert',ModActionDefinition.ALERT,1,0),new ModActionDefinition(2,'Mute 1h',ModActionDefinition.MUTE,2,0),new ModActionDefinition(3,'Ban 18h',ModActionDefinition.BAN,3,0),new ModActionDefinition(4,'Ban 7 days',ModActionDefinition.BAN,4,0),new ModActionDefinition(5,'Ban 30 days (step 1)',ModActionDefinition.BAN,5,0),new ModActionDefinition(7,'Ban 30 days (step 2)',ModActionDefinition.BAN,7,0),new ModActionDefinition(6,'Ban 100 years',ModActionDefinition.BAN,6,0),new ModActionDefinition(106,'Ban avatar-only 100 years',ModActionDefinition.BAN,6,0),new ModActionDefinition(101,'Kick',ModActionDefinition.KICK,0,0),new ModActionDefinition(102,'Lock trade 1 week',ModActionDefinition.TRADE_LOCK,0,168),new ModActionDefinition(104,'Lock trade permanent',ModActionDefinition.TRADE_LOCK,0,876000),new ModActionDefinition(105,'Message',ModActionDefinition.MESSAGE,0,0)];export const ModToolsUserModActionView=props=>{const{user=null,onCloseClick=null}=props;const[selectedTopic,setSelectedTopic]=useState(-1);const[selectedAction,setSelectedAction]=useState(-1);const[message,setMessage]=useState('');const{modToolsState=null}=useModToolsContext();const{cfhCategories=null,settings=null}=modToolsState;const topics=useMemo(()=>{const values=[];if(cfhCategories&&cfhCategories.length){for(const category of cfhCategories){for(const topic of category.topics)values.push(topic);}}return values;},[cfhCategories]);const sendAlert=message=>{NotificationUtilities.simpleAlert(message,NotificationAlertType.DEFAULT,null,null,'Error');};const sendDefaultSanction=()=>{let errorMessage=null;const category=topics[selectedTopic];if(selectedTopic===-1)errorMessage='You must select a CFH topic';if(errorMessage)return sendAlert(errorMessage);const messageOrDefault=message.trim().length===0?LocalizeText(`help.cfh.topic.${category.id}`):message;SendMessageComposer(new DefaultSanctionMessageComposer(user.userId,selectedTopic,messageOrDefault));onCloseClick();};const sendSanction=()=>{let errorMessage=null;const category=topics[selectedTopic];const sanction=MOD_ACTION_DEFINITIONS[selectedAction];if(selectedTopic===-1||selectedAction===-1)errorMessage='You must select a CFH topic and Sanction';else if(!settings||!settings.cfhPermission)errorMessage='You do not have permission to do this';else if(!category)errorMessage='You must select a CFH topic';else if(!sanction)errorMessage='You must select a sanction';if(errorMessage){sendAlert(errorMessage);return;}const messageOrDefault=message.trim().length===0?LocalizeText(`help.cfh.topic.${category.id}`):message;switch(sanction.actionType){case ModActionDefinition.ALERT:{if(!settings.alertPermission){sendAlert('You have insufficient permissions');return;}SendMessageComposer(new ModAlertMessageComposer(user.userId,messageOrDefault,category.id));break;}case ModActionDefinition.MUTE:SendMessageComposer(new ModMuteMessageComposer(user.userId,messageOrDefault,category.id));break;case ModActionDefinition.BAN:{if(!settings.banPermission){sendAlert('You have insufficient permissions');return;}SendMessageComposer(new ModBanMessageComposer(user.userId,messageOrDefault,category.id,selectedAction,sanction.actionId===106));break;}case ModActionDefinition.KICK:{if(!settings.kickPermission){sendAlert('You have insufficient permissions');return;}SendMessageComposer(new ModKickMessageComposer(user.userId,messageOrDefault,category.id));break;}case ModActionDefinition.TRADE_LOCK:{const numSeconds=sanction.actionLengthHours*60;SendMessageComposer(new ModTradingLockMessageComposer(user.userId,messageOrDefault,numSeconds,category.id));break;}case ModActionDefinition.MESSAGE:{if(message.trim().length===0){sendAlert('Please write a message to user');return;}SendMessageComposer(new ModMessageMessageComposer(user.userId,message,category.id));break;}}onCloseClick();};if(!user)return null;return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-mod-tools-user-action\",theme:\"modtool-windows\",windowPosition:DraggableWindowPosition.TOP_CENTER,children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:'Mod Action: '+(user?user.username:''),onCloseClick:()=>onCloseClick()}),/*#__PURE__*/_jsxs(NitroCardContentView,{className:\"text-black\",children:[/*#__PURE__*/_jsxs(\"select\",{className:\"form-select form-select-sm\",value:selectedTopic,onChange:event=>setSelectedTopic(parseInt(event.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:-1,disabled:true,children:\"CFH Topic\"}),topics.map((topic,index)=>/*#__PURE__*/_jsx(\"option\",{value:index,children:LocalizeText('help.cfh.topic.'+topic.id)},index))]}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-select form-select-sm\",value:selectedAction,onChange:event=>setSelectedAction(parseInt(event.target.value)),children:[/*#__PURE__*/_jsx(\"option\",{value:-1,disabled:true,children:\"Sanction Type\"}),MOD_ACTION_DEFINITIONS.map((action,index)=>/*#__PURE__*/_jsx(\"option\",{value:index,children:action.name},index))]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{small:true,children:\"Optional message type, overrides default\"}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",value:message,onChange:event=>setMessage(event.target.value)})]}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"between\",gap:1,children:[/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:sendDefaultSanction,children:\"Default Sanction\"}),/*#__PURE__*/_jsx(Button,{variant:\"success\",onClick:sendSanction,children:\"Sanction\"})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}