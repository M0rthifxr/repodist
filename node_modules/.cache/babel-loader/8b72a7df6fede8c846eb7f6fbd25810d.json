{"ast":null,"code":"import{ApplyTonerComposer,RoomControllerLevel,RoomEngineTriggerWidgetEvent,RoomObjectVariable}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import ReactSlider from'react-slider';import{GetRoomEngine,GetSessionDataManager,LocalizeText,RoomWidgetUpdateBackgroundColorPreviewEvent,RoomWidgetUpdateRoomObjectEvent,SendMessageComposer}from'../../../../../api';import{Button,Column,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../../../common';import{UseEventDispatcherHook,UseRoomEngineEvent}from'../../../../../hooks';import{useRoomContext}from'../../../RoomContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const FurnitureBackgroundColorView=props=>{const[objectId,setObjectId]=useState(-1);const[hue,setHue]=useState(0);const[saturation,setSaturation]=useState(0);const[lightness,setLightness]=useState(0);const{roomSession=null,eventDispatcher=null}=useRoomContext();const close=useCallback(()=>{eventDispatcher.dispatchEvent(new RoomWidgetUpdateBackgroundColorPreviewEvent(RoomWidgetUpdateBackgroundColorPreviewEvent.CLEAR_PREVIEW));setObjectId(-1);},[eventDispatcher]);const canOpenBackgroundToner=useCallback(()=>{return roomSession.isRoomOwner||roomSession.controllerLevel>=RoomControllerLevel.GUEST||GetSessionDataManager().isModerator;},[roomSession]);const onRoomEngineObjectEvent=useCallback(event=>{switch(event.type){case RoomEngineTriggerWidgetEvent.REQUEST_BACKGROUND_COLOR:{if(!canOpenBackgroundToner())return;const roomObject=GetRoomEngine().getRoomObject(event.roomId,event.objectId,event.category);const model=roomObject.model;setObjectId(roomObject.id);setHue(parseInt(model.getValue(RoomObjectVariable.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)));setSaturation(parseInt(model.getValue(RoomObjectVariable.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)));setLightness(parseInt(model.getValue(RoomObjectVariable.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)));return;}case RoomWidgetUpdateRoomObjectEvent.FURNI_REMOVED:{if(objectId!==event.objectId)return;close();return;}}},[objectId,canOpenBackgroundToner,close]);UseRoomEngineEvent(RoomEngineTriggerWidgetEvent.REQUEST_BACKGROUND_COLOR,onRoomEngineObjectEvent);UseEventDispatcherHook(RoomWidgetUpdateRoomObjectEvent.FURNI_REMOVED,eventDispatcher,onRoomEngineObjectEvent);const processAction=useCallback(name=>{switch(name){case'apply':SendMessageComposer(new ApplyTonerComposer(objectId,hue,saturation,lightness));break;case'toggle':roomSession.useMultistateItem(objectId);break;}},[roomSession,objectId,hue,saturation,lightness]);useEffect(()=>{if(objectId===-1)return;eventDispatcher.dispatchEvent(new RoomWidgetUpdateBackgroundColorPreviewEvent(RoomWidgetUpdateBackgroundColorPreviewEvent.PREVIEW,hue,saturation,lightness));},[eventDispatcher,objectId,hue,saturation,lightness]);if(objectId===-1)return null;return/*#__PURE__*/_jsxs(NitroCardView,{theme:\"primary\",className:\"nitro-room-widget-toner\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('widget.backgroundcolor.title'),onCloseClick:close}),/*#__PURE__*/_jsxs(NitroCardContentView,{overflow:\"hidden\",justifyContent:\"between\",children:[/*#__PURE__*/_jsxs(Column,{overflow:\"auto\",gap:1,children:[/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(Text,{bold:true,children:LocalizeText('widget.backgroundcolor.hue')}),/*#__PURE__*/_jsx(ReactSlider,{className:'nitro-slider',min:0,max:360,value:hue,onChange:event=>setHue(event),thumbClassName:'thumb degree',renderThumb:(props,state)=>/*#__PURE__*/_jsx(\"div\",{...props,children:state.valueNow})})]}),/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(Text,{bold:true,children:LocalizeText('widget.backgroundcolor.saturation')}),/*#__PURE__*/_jsx(ReactSlider,{className:'nitro-slider',min:0,max:255,value:saturation,onChange:event=>setSaturation(event),thumbClassName:'thumb percent',renderThumb:(props,state)=>/*#__PURE__*/_jsx(\"div\",{...props,children:state.valueNow})})]}),/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(Text,{bold:true,children:LocalizeText('widget.backgroundcolor.lightness')}),/*#__PURE__*/_jsx(ReactSlider,{className:'nitro-slider',min:0,max:255,value:lightness,onChange:event=>setLightness(event),thumbClassName:'thumb percent',renderThumb:(props,state)=>/*#__PURE__*/_jsx(\"div\",{...props,children:state.valueNow})})]})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"primary\",onClick:event=>processAction('toggle'),children:LocalizeText('widget.backgroundcolor.button.on')}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"primary\",onClick:event=>processAction('apply'),children:LocalizeText('widget.backgroundcolor.button.apply')})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}