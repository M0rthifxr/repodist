{"ast":null,"code":"import{AvatarSetType}from'../../../../avatar/enum/AvatarSetType';import{RoomObjectVariable}from'../../RoomObjectVariable';import{FurnitureMannequinVisualizationData}from'./FurnitureMannequinVisualizationData';import{FurnitureVisualization}from'./FurnitureVisualization';export class FurnitureMannequinVisualization extends FurnitureVisualization{constructor(){super();this._data=void 0;this._mannequinScale=void 0;this._figure=void 0;this._gender=void 0;this._dynamicAssetName=void 0;this._needsUpdate=void 0;this._placeHolderFigure=void 0;this._disposed=void 0;this._mannequinScale=-1;this._figure=null;this._gender=null;this._dynamicAssetName=null;this._needsUpdate=false;this._placeHolderFigure='hd-99999-99998';this._disposed=false;}initialize(data){if(!(data instanceof FurnitureMannequinVisualizationData))return false;return super.initialize(data);}dispose(){if(this._disposed)return;this._disposed=true;if(this._dynamicAssetName&&this.asset){this.asset.disposeAsset(this._dynamicAssetName);this._dynamicAssetName=null;}super.dispose();}updateObject(scale,direction){const updateObject=super.updateObject(scale,direction);if(updateObject){if(this._mannequinScale!==scale){this._mannequinScale=scale;this.updateAvatar();}}return updateObject;}updateModel(scale){let updateModel=super.updateModel(scale);if(updateModel){const figure=this.object.model.getValue(RoomObjectVariable.FURNITURE_MANNEQUIN_FIGURE)||null;if(figure){this._figure=figure+'.'+this._placeHolderFigure;this._gender=this.object.model.getValue(RoomObjectVariable.FURNITURE_MANNEQUIN_GENDER)||null;this.updateAvatar();}}updateModel=updateModel||this._needsUpdate;this._needsUpdate=false;return updateModel;}updateAvatar(){let forceUpdate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this.avatarExists()||forceUpdate){const avatarImage=this._data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);if(avatarImage){avatarImage.setDirection(AvatarSetType.FULL,this.direction);if(this._dynamicAssetName)this.asset.disposeAsset(this._dynamicAssetName);this.asset.addAsset(this.getAvatarAssetName(),avatarImage.getImage(AvatarSetType.FULL,false,1,false),true);this._dynamicAssetName=this.getAvatarAssetName();this._needsUpdate=true;avatarImage.dispose();}}}avatarExists(){return this._figure&&this.getAsset(this.getAvatarAssetName())!==null;}getAvatarAssetName(){return'mannequin_'+this._figure+'_'+this._mannequinScale+'_'+this.direction+'_'+this.object.id;}resetFigure(figure){if(figure===this._figure)this.updateAvatar(true);}getSpriteAssetName(scale,layerId){const tag=this.getLayerTag(scale,this.direction,layerId);if(this._figure&&tag===FurnitureMannequinVisualization.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()){return this.getAvatarAssetName();}return super.getSpriteAssetName(scale,layerId);}getLayerXOffset(scale,direction,layerId){const tag=this.getLayerTag(scale,direction,layerId);if(tag===FurnitureMannequinVisualization.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists())return-this.getSprite(layerId).width/2;return super.getLayerXOffset(scale,direction,layerId);}getLayerYOffset(scale,direction,layerId){const tag=this.getLayerTag(scale,direction,layerId);if(tag===FurnitureMannequinVisualization.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists())return-this.getSprite(layerId).height;return super.getLayerYOffset(scale,direction,layerId);}get disposed(){return this._disposed;}}FurnitureMannequinVisualization.AVATAR_IMAGE_SPRITE_TAG='avatar_image';","map":null,"metadata":{},"sourceType":"module"}