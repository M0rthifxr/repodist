{"ast":null,"code":"import{ColorData}from'../data/ColorData';import{LayerData}from'../data/LayerData';import{SizeData}from'../data/SizeData';export class FurnitureVisualizationData{constructor(){this._type=void 0;this._sizes=void 0;this._sizeDatas=void 0;this._lastSize=void 0;this._lastSizeScale=void 0;this._lastSizeData=void 0;this._lastSizeDataScale=void 0;this._type='';this._sizes=[];this._sizeDatas=new Map();this._lastSize=-1;this._lastSizeScale=-1;this._lastSizeData=null;this._lastSizeDataScale=-1;}initialize(asset){this.reset();if(!asset)return false;this._type=asset.name;if(!this.defineVisualizations(asset.visualizations)){this.reset();return false;}return true;}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const size of this._sizeDatas.values())size&&size.dispose();this._sizeDatas=null;}this._lastSizeData=null;this._sizes=null;}reset(){this._type='';if(this._sizeDatas&&this._sizeDatas.size){for(const size of this._sizeDatas.values())size&&size.dispose();}this._sizeDatas.clear();this._sizes=[];this._lastSizeData=null;this._lastSizeDataScale=-1;}createSizeData(scale,layerCount,angle){return new SizeData(layerCount,angle);}defineVisualizations(visualizations){if(!visualizations)return false;for(const visualizationId in visualizations){const visualization=visualizations[visualizationId];const layerCount=visualization.layerCount;const angle=visualization.angle;let size=visualization.size;if(size<1)size=1;if(this._sizeDatas.get(size))return false;const sizeData=this.createSizeData(size,layerCount,angle);if(!sizeData)return false;for(const key in visualization){//@ts-ignore\nconst data=visualization[key];if(!this.processVisualElement(sizeData,key,data)){sizeData.dispose();return false;}}this._sizeDatas.set(size,sizeData);this._sizes.push(size);}this._sizes.sort();return true;}processVisualElement(sizeData,key,data){if(!sizeData||!key||!data)return false;switch(key){case'layers':if(!sizeData.processLayers(data))return false;break;case'directions':if(!sizeData.processDirections(data))return false;break;case'colors':if(!sizeData.processColors(data))return false;break;}return true;}getValidSize(scale){if(scale===this._lastSizeScale)return this._lastSize;const sizeIndex=this.getSizeIndex(scale);let newScale=-1;if(sizeIndex<this._sizes.length)newScale=this._sizes[sizeIndex];this._lastSizeScale=scale;this._lastSize=newScale;return newScale;}getSizeIndex(size){if(size<=0)return 0;let index=0;let iterator=1;while(iterator<this._sizes.length){if(this._sizes[iterator]>size){if(this._sizes[iterator]/size<size/this._sizes[iterator-1])index=iterator;break;}index=iterator;iterator++;}return index;}getSizeData(size){if(size===this._lastSizeDataScale)return this._lastSizeData;const sizeIndex=this.getSizeIndex(size);if(sizeIndex<this._sizes.length)this._lastSizeData=this._sizeDatas.get(this._sizes[sizeIndex]);else this._lastSizeData=null;this._lastSizeDataScale=size;return this._lastSizeData;}getLayerCount(scale){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_COUNT;return size.layerCount;}getValidDirection(scale,direction){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_DIRECTION;return size.getValidDirection(direction);}getLayerTag(scale,direction,layerId){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_TAG;return size.getLayerTag(direction,layerId);}getLayerInk(scale,direction,layerId){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_INK;return size.getLayerInk(direction,layerId);}getLayerAlpha(scale,direction,layerId){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_ALPHA;return size.getLayerAlpha(direction,layerId);}getLayerColor(scale,layerId,colorId){const size=this.getSizeData(scale);if(!size)return ColorData.DEFAULT_COLOR;return size.getLayerColor(layerId,colorId);}getLayerIgnoreMouse(scale,direction,layerId){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_IGNORE_MOUSE;return size.getLayerIgnoreMouse(direction,layerId);}getLayerXOffset(scale,direction,layerId){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_XOFFSET;return size.getLayerXOffset(direction,layerId);}getLayerYOffset(scale,direction,layerId){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_YOFFSET;return size.getLayerYOffset(direction,layerId);}getLayerZOffset(scale,direction,layerId){const size=this.getSizeData(scale);if(!size)return LayerData.DEFAULT_ZOFFSET;return size.getLayerZOffset(direction,layerId);}get type(){return this._type;}}FurnitureVisualizationData.LAYER_LETTERS=['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'];","map":null,"metadata":{},"sourceType":"module"}