{"ast":null,"code":"import{HabboWebTools,RoomEnterEffect}from'@nitrots/nitro-renderer';import{CreateLinkEvent,GetConfiguration,GetNitroInstance,LocalizeText,PlaySound}from'..';import{NotificationAlertEvent,NotificationConfirmEvent}from'../../events';import{NotificationBubbleEvent}from'../../events/notification-center/NotificationBubbleEvent';import{DispatchUiEvent}from'../../hooks';import{NotificationAlertType}from'./NotificationAlertType';import{NotificationBubbleType}from'./NotificationBubbleType';export class NotificationUtilities{static cleanText(text){return text.replace(/\\\\r/g,'\\r');}static getTimeZeroPadded(time){const text='0'+time;return text.substr(text.length-2,text.length);}static getMainNotificationConfig(){return GetConfiguration('notification',{});}static getNotificationConfig(key){const mainConfig=this.getMainNotificationConfig();if(!mainConfig)return null;return mainConfig[key];}static getNotificationPart(options,type,key,localize){if(options.has(key))return options.get(key);const localizeKey=['notification',type,key].join('.');if(GetNitroInstance().localization.hasValue(localizeKey)||localize){return LocalizeText(localizeKey,Array.from(options.keys()),Array.from(options.values()));}return null;}static getNotificationImageUrl(options,type){let imageUrl=options.get('image');if(!imageUrl)imageUrl=GetConfiguration('image.library.notifications.url','').replace('%image%',type.replace(/\\./g,'_'));return LocalizeText(imageUrl);}static showNotification(type){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!options)options=new Map();const configuration=this.getNotificationConfig('notification.'+type);if(configuration)for(const key in configuration)options.set(key,configuration[key]);const title=this.getNotificationPart(options,type,'title',true);const message=this.getNotificationPart(options,type,'message',true).replace(/\\\\r/g,'\\r');const linkTitle=this.getNotificationPart(options,type,'linkTitle',false);const linkUrl=this.getNotificationPart(options,type,'linkUrl',false);const image=this.getNotificationImageUrl(options,type);if(options.get('display')==='BUBBLE'){this.showSingleBubble(LocalizeText(message),NotificationBubbleType.INFO,image,linkUrl);}else{this.simpleAlert(message,type,linkUrl,linkTitle,title,image);}if(options.get('sound'))PlaySound(options.get('sound'));}static showSingleBubble(message,type){let imageUrl=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;let internalLink=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;if(this.BUBBLES_DISABLED)return;DispatchUiEvent(new NotificationBubbleEvent(message,type,imageUrl,internalLink));}static showClubGiftNotification(numGifts){if(numGifts<=0)return;this.showSingleBubble(numGifts.toString(),NotificationBubbleType.CLUBGIFT,null,'catalog/open/'+GetConfiguration('catalog.links')['hc.hc_gifts']);}static handleMOTD(messages){messages=messages.map(message=>this.cleanText(message));DispatchUiEvent(new NotificationAlertEvent(messages,NotificationAlertType.MOTD,null,null,LocalizeText('notifications.motd.title')));}static confirm(message,onConfirm,onCancel){let confirmText=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;let cancelText=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let title=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;let type=arguments.length>6&&arguments[6]!==undefined?arguments[6]:null;if(!confirmText||!confirmText.length)confirmText=LocalizeText('generic.confirm');if(!cancelText||!cancelText.length)cancelText=LocalizeText('generic.cancel');if(!title||!title.length)title=LocalizeText('notifications.broadcast.title');DispatchUiEvent(new NotificationConfirmEvent(type,this.cleanText(message),onConfirm,onCancel,confirmText,cancelText,title));}static simpleAlert(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let clickUrl=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;let clickUrlText=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;let title=arguments.length>4&&arguments[4]!==undefined?arguments[4]:null;let imageUrl=arguments.length>5&&arguments[5]!==undefined?arguments[5]:null;if(!title||!title.length)title=LocalizeText('notifications.broadcast.title');if(!type||!type.length)type=NotificationAlertType.DEFAULT;DispatchUiEvent(new NotificationAlertEvent([this.cleanText(message)],type,clickUrl,clickUrlText,title,imageUrl));}static showNitroAlert(){DispatchUiEvent(new NotificationAlertEvent(null,NotificationAlertType.NITRO));}static showModeratorMessage(message){let url=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;let showHabboWay=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;this.simpleAlert(message,NotificationAlertType.DEFAULT,url,LocalizeText('mod.alert.link'),LocalizeText('mod.alert.title'));}static handleModeratorCaution(message){let url=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.showModeratorMessage(message,url);}static handleModeratorMessage(message){let url=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.showModeratorMessage(message,url,false);}static handleUserBannedMessage(message){this.showModeratorMessage(message);}static handleHotelClosedMessage(open,minute,thrownOut){this.simpleAlert(LocalizeText('opening.hours.'+(thrownOut?'disconnected':'closed'),['h','m'],[this.getTimeZeroPadded(open),this.getTimeZeroPadded(minute)]),NotificationAlertType.DEFAULT,null,null,LocalizeText('opening.hours.title'));}static handleHotelMaintenanceMessage(minutesUntilMaintenance,duration){this.simpleAlert(LocalizeText('maintenance.shutdown',['m','d'],[minutesUntilMaintenance.toString(),duration.toString()]),NotificationAlertType.DEFAULT,null,null,LocalizeText('opening.hours.title'));}static handleHotelClosingMessage(minutes){this.simpleAlert(LocalizeText('opening.hours.shutdown',['m'],[minutes.toString()]),NotificationAlertType.DEFAULT,null,null,LocalizeText('opening.hours.title'));}static handleLoginFailedHotelClosedMessage(openHour,openMinutes){this.simpleAlert(LocalizeText('opening.hours.disconnected',['h','m'],[openHour.toString(),openMinutes.toString()]),NotificationAlertType.DEFAULT,null,null,LocalizeText('opening.hours.title'));}static openUrl(url){if(!url||!url.length)return;if(url.startsWith('http')){HabboWebTools.openWebPage(url);}else{CreateLinkEvent(url);}}static showModerationDisclaimer(){if(RoomEnterEffect.isRunning()){if(this.MODERATION_DISCLAIMER_TIMEOUT)return;this.MODERATION_DISCLAIMER_TIMEOUT=setTimeout(()=>{this.showModerationDisclaimer();},RoomEnterEffect.totalRunningTime+this.MODERATION_DISCLAIMER_DELAY_MS);}else{if(this.MODERATION_DISCLAIMER_SHOWN)return;this.showSingleBubble(LocalizeText('mod.chatdisclaimer'),NotificationBubbleType.INFO);this.MODERATION_DISCLAIMER_SHOWN=true;}}}NotificationUtilities.MODERATION_DISCLAIMER_SHOWN=false;NotificationUtilities.MODERATION_DISCLAIMER_DELAY_MS=5000;NotificationUtilities.MODERATION_DISCLAIMER_TIMEOUT=null;NotificationUtilities.BUBBLES_DISABLED=false;","map":null,"metadata":{},"sourceType":"module"}