{"ast":null,"code":"import{ObjectDataFactory,RoomEngineTriggerWidgetEvent,RoomObjectCategory,RoomObjectVariable}from'@nitrots/nitro-renderer';import{useCallback,useState}from'react';import{GetRoomEngine,LocalizeText}from'../../../../../api';import{Column,Flex,Text}from'../../../../../common';import{UseRoomEngineEvent}from'../../../../../hooks';import{useRoomContext}from'../../../RoomContext';import{ObjectLocationView}from'../../object-location/ObjectLocationView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const SCORE_TYPES=['perteam','mostwins','classic'];const CLEAR_TYPES=['alltime','daily','weekly','monthly'];export const FurnitureHighScoreView=props=>{const[stuffDatas,setStuffDatas]=useState(new Map());const{roomSession=null}=useRoomContext();const onRoomEngineTriggerWidgetEvent=useCallback(event=>{switch(event.type){case RoomEngineTriggerWidgetEvent.REQUEST_HIGH_SCORE_DISPLAY:{const object=GetRoomEngine().getRoomObject(roomSession.roomId,event.objectId,event.category);if(!object)return;const formatKey=object.model.getValue(RoomObjectVariable.FURNITURE_DATA_FORMAT);const stuffData=ObjectDataFactory.getData(formatKey);stuffData.initializeFromRoomObjectModel(object.model);setStuffDatas(prevValue=>{const newValue=new Map(prevValue);newValue.set(object.id,stuffData);return newValue;});return;}case RoomEngineTriggerWidgetEvent.REQUEST_HIDE_HIGH_SCORE_DISPLAY:if(event.roomId!==roomSession.roomId)return;setStuffDatas(prevValue=>{const newValue=new Map(prevValue);newValue.delete(event.objectId);return newValue;});return;}},[roomSession]);UseRoomEngineEvent(RoomEngineTriggerWidgetEvent.REQUEST_HIGH_SCORE_DISPLAY,onRoomEngineTriggerWidgetEvent);UseRoomEngineEvent(RoomEngineTriggerWidgetEvent.REQUEST_HIDE_HIGH_SCORE_DISPLAY,onRoomEngineTriggerWidgetEvent);if(!stuffDatas.size)return null;return/*#__PURE__*/_jsx(_Fragment,{children:Array.from(stuffDatas.entries()).map((_ref,index)=>{let[objectId,stuffData]=_ref;return/*#__PURE__*/_jsx(ObjectLocationView,{objectId:objectId,category:RoomObjectCategory.FLOOR,children:/*#__PURE__*/_jsxs(Column,{className:\"nitro-widget-high-score\",gap:0,children:[/*#__PURE__*/_jsx(Flex,{center:true,className:\"nitro-widget-high-score-header\",children:/*#__PURE__*/_jsx(Text,{small:true,bold:true,children:LocalizeText('high.score.display.caption',['scoretype','cleartype'],[LocalizeText(`high.score.display.scoretype.${SCORE_TYPES[stuffData.scoreType]}`),LocalizeText(`high.score.display.cleartype.${CLEAR_TYPES[stuffData.clearType]}`)])})}),/*#__PURE__*/_jsxs(Column,{overflow:\"hidden\",gap:1,className:\"h-100\",children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",className:\"score-board-header mt-1 p-1\",children:[/*#__PURE__*/_jsx(Text,{small:true,variant:\"black\",className:\"col-8\",children:LocalizeText('high.score.display.users.header')}),/*#__PURE__*/_jsx(Text,{small:true,variant:\"black\",className:\"col-4\",children:LocalizeText('high.score.display.score.header')})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsx(Column,{overflow:\"auto\",gap:1,className:\"overflow-y-auto high-score-results p-2\",children:stuffData.entries.map((entry,index)=>{return/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",children:[/*#__PURE__*/_jsx(Text,{small:true,variant:\"white\",className:\"col-8\",children:entry.users.join(', ')}),/*#__PURE__*/_jsx(Text,{small:true,center:true,variant:\"white\",className:\"col-4\",children:entry.score})]},index);})}),/*#__PURE__*/_jsx(\"i\",{className:\"trophy position-absolute\"}),/*#__PURE__*/_jsx(Flex,{center:true,className:\"bottom-text\",children:/*#__PURE__*/_jsx(Text,{small:true,center:true,children:LocalizeText('high.score.display.congratulations.footer')})})]})]})},index);})});};","map":null,"metadata":{},"sourceType":"module"}