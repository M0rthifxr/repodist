{"ast":null,"code":"import{Nitro}from'../../../../Nitro';import{ObjectDataUpdateMessage}from'../../../messages/ObjectDataUpdateMessage';import{RoomObjectVariable}from'../../RoomObjectVariable';import{FurnitureMultiStateLogic}from'./FurnitureMultiStateLogic';export class FurnitureVoteCounterLogic extends FurnitureMultiStateLogic{constructor(){super();this._total=void 0;this._lastUpdate=void 0;this._interval=void 0;this._total=0;this._lastUpdate=0;this._interval=33;}processUpdateMessage(message){super.processUpdateMessage(message);if(message instanceof ObjectDataUpdateMessage){const stuffData=message.data;if(!stuffData)return;this.updateTotal(stuffData.result);}}updateTotal(k){this._total=k;if(!this._lastUpdate){this.object.model.setValue(RoomObjectVariable.FURNITURE_VOTE_COUNTER_COUNT,k);this._lastUpdate=Nitro.instance.time;return;}if(this._total!==this.currentTotal){const difference=Math.abs(this._total-this.currentTotal);if(difference*FurnitureVoteCounterLogic.UPDATE_INTERVAL>FurnitureVoteCounterLogic.MAX_UPDATE_TIME){this._interval=FurnitureVoteCounterLogic.MAX_UPDATE_TIME/difference;}else{this._interval=FurnitureVoteCounterLogic.UPDATE_INTERVAL;}this._lastUpdate=Nitro.instance.time;}}update(time){super.update(time);if(this.object){if(this.currentTotal!==this._total&&time>=this._lastUpdate+this._interval){const _local_2=time-this._lastUpdate;let _local_3=_local_2/this._interval;let _local_4=1;if(this._total<this.currentTotal)_local_4=-1;if(_local_3>_local_4*(this._total-this.currentTotal))_local_3=_local_4*(this._total-this.currentTotal);this.object.model.setValue(RoomObjectVariable.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+_local_4*_local_3);this._lastUpdate=time-(_local_2-_local_3*this._interval);}}}get currentTotal(){return this.object.model.getValue(RoomObjectVariable.FURNITURE_VOTE_COUNTER_COUNT);}}FurnitureVoteCounterLogic.UPDATE_INTERVAL=33;FurnitureVoteCounterLogic.MAX_UPDATE_TIME=1000;","map":null,"metadata":{},"sourceType":"module"}