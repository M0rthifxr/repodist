{"ast":null,"code":"import{FriendlyTime,GetModeratorUserInfoMessageComposer,ModeratorUserInfoEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useMemo,useState}from'react';import{LocalizeText,SendMessageComposer}from'../../../../api';import{Button,Column,DraggableWindowPosition,Grid,NitroCardContentView,NitroCardHeaderView,NitroCardView}from'../../../../common';import{ModToolsOpenUserChatlogEvent}from'../../../../events';import{DispatchUiEvent,UseMessageEventHook}from'../../../../hooks';import{ModToolsUserModActionView}from'./ModToolsUserModActionView';import{ModToolsUserRoomVisitsView}from'./ModToolsUserRoomVisitsView';import{ModToolsUserSendMessageView}from'./ModToolsUserSendMessageView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const ModToolsUserView=props=>{const{onCloseClick=null,userId=null}=props;const[userInfo,setUserInfo]=useState(null);const[sendMessageVisible,setSendMessageVisible]=useState(false);const[modActionVisible,setModActionVisible]=useState(false);const[roomVisitsVisible,setRoomVisitsVisible]=useState(false);const onModtoolUserInfoEvent=useCallback(event=>{const parser=event.getParser();if(!parser||parser.data.userId!==userId)return;setUserInfo(parser.data);},[userId]);UseMessageEventHook(ModeratorUserInfoEvent,onModtoolUserInfoEvent);const userProperties=useMemo(()=>{if(!userInfo)return null;return[{localeKey:'modtools.userinfo.userName',value:userInfo.userName,showOnline:true},{localeKey:'modtools.userinfo.cfhCount',value:userInfo.cfhCount.toString()},{localeKey:'modtools.userinfo.abusiveCfhCount',value:userInfo.abusiveCfhCount.toString()},{localeKey:'modtools.userinfo.cautionCount',value:userInfo.cautionCount.toString()},{localeKey:'modtools.userinfo.banCount',value:userInfo.banCount.toString()},{localeKey:'modtools.userinfo.lastSanctionTime',value:userInfo.lastSanctionTime},{localeKey:'modtools.userinfo.tradingLockCount',value:userInfo.tradingLockCount.toString()},{localeKey:'modtools.userinfo.tradingExpiryDate',value:userInfo.tradingExpiryDate},{localeKey:'modtools.userinfo.minutesSinceLastLogin',value:FriendlyTime.format(userInfo.minutesSinceLastLogin*60,'.ago',2)},{localeKey:'modtools.userinfo.lastPurchaseDate',value:userInfo.lastPurchaseDate},{localeKey:'modtools.userinfo.primaryEmailAddress',value:userInfo.primaryEmailAddress},{localeKey:'modtools.userinfo.identityRelatedBanCount',value:userInfo.identityRelatedBanCount.toString()},{localeKey:'modtools.userinfo.registrationAgeInMinutes',value:FriendlyTime.format(userInfo.registrationAgeInMinutes*60,'.ago',2)},{localeKey:'modtools.userinfo.userClassification',value:userInfo.userClassification}];},[userInfo]);useEffect(()=>{SendMessageComposer(new GetModeratorUserInfoMessageComposer(userId));},[userId]);if(!userInfo)return null;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-mod-tools-user\",theme:\"modtool-windows\",windowPosition:DraggableWindowPosition.TOP_CENTER,children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('modtools.userinfo.title',['username'],[userInfo.userName]),onCloseClick:()=>onCloseClick()}),/*#__PURE__*/_jsx(NitroCardContentView,{className:\"text-black\",children:/*#__PURE__*/_jsxs(Grid,{overflow:\"hidden\",className:\"mod-content p-2\",children:[/*#__PURE__*/_jsx(Column,{size:8,overflow:\"auto\",children:/*#__PURE__*/_jsx(\"table\",{className:\"table table-striped table-sm table-text-small text-black m-0\",children:/*#__PURE__*/_jsx(\"tbody\",{children:userProperties.map((property,index)=>{return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:LocalizeText(property.localeKey)}),/*#__PURE__*/_jsxs(\"td\",{children:[property.value,property.showOnline&&/*#__PURE__*/_jsx(\"i\",{className:`icon icon-pf-${userInfo.online?'online':'offline'} ms-2`})]})]},index);})})})}),/*#__PURE__*/_jsxs(Column,{size:4,gap:1,children:[/*#__PURE__*/_jsx(Button,{onClick:event=>DispatchUiEvent(new ModToolsOpenUserChatlogEvent(userId)),children:\"Room Chat\"}),/*#__PURE__*/_jsx(Button,{onClick:event=>setSendMessageVisible(!sendMessageVisible),children:\"Send Message\"}),/*#__PURE__*/_jsx(Button,{onClick:event=>setRoomVisitsVisible(!roomVisitsVisible),children:\"Room Visits\"}),/*#__PURE__*/_jsx(Button,{onClick:event=>setModActionVisible(!modActionVisible),children:\"Mod Action\"})]})]})})]}),sendMessageVisible&&/*#__PURE__*/_jsx(ModToolsUserSendMessageView,{user:{userId:userId,username:userInfo.userName},onCloseClick:()=>setSendMessageVisible(false)}),modActionVisible&&/*#__PURE__*/_jsx(ModToolsUserModActionView,{user:{userId:userId,username:userInfo.userName},onCloseClick:()=>setModActionVisible(false)}),roomVisitsVisible&&/*#__PURE__*/_jsx(ModToolsUserRoomVisitsView,{userId:userId,onCloseClick:()=>setRoomVisitsVisible(false)})]});};","map":null,"metadata":{},"sourceType":"module"}