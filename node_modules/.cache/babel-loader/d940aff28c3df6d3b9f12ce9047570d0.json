{"ast":null,"code":"import{useState}from'react';import{CalendarItemState,GetSessionDataManager,LocalizeText}from'../../api';import{Base,Button,Column,Flex,Grid,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../common';import{CalendarItemView}from'./CalendarItemView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const TOTAL_SHOWN_ITEMS=5;export const CalendarView=props=>{const{close=null,campaignName=null,currentDay=null,numDays=null,missedDays=null,openedDays=null,openPackage=null,receivedProducts=null}=props;const[selectedDay,setSelectedDay]=useState(currentDay);const[index,setIndex]=useState(Math.max(0,selectedDay-1));const getDayState=day=>{if(openedDays.includes(day))return CalendarItemState.STATE_UNLOCKED;if(day>currentDay)return CalendarItemState.STATE_LOCKED_FUTURE;if(missedDays.includes(day))return CalendarItemState.STATE_LOCKED_EXPIRED;return CalendarItemState.STATE_LOCKED_AVAILABLE;};const dayMessage=day=>{const state=getDayState(day);switch(state){case CalendarItemState.STATE_UNLOCKED:return LocalizeText('campaign.calendar.info.unlocked');case CalendarItemState.STATE_LOCKED_FUTURE:return LocalizeText('campaign.calendar.info.future');case CalendarItemState.STATE_LOCKED_EXPIRED:return LocalizeText('campaign.calendar.info.expired');default:return LocalizeText('campaign.calendar.info.available.desktop');}};const onClickNext=()=>{const nextDay=selectedDay+1;if(nextDay===numDays)return;setSelectedDay(nextDay);if(index+TOTAL_SHOWN_ITEMS<nextDay+1)setIndex(index+1);};const onClickPrev=()=>{const prevDay=selectedDay-1;if(prevDay<0)return;setSelectedDay(prevDay);if(index>prevDay)setIndex(index-1);};const onClickItem=item=>{if(selectedDay===item){const state=getDayState(item);if(state===CalendarItemState.STATE_LOCKED_AVAILABLE)openPackage(item,false);return;}setSelectedDay(item);};const forceOpen=()=>{const id=selectedDay;const state=getDayState(id);if(state!==CalendarItemState.STATE_UNLOCKED)openPackage(id,true);};return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-campaign-calendar\",theme:\"primary\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText(`campaign.calendar.${campaignName}.title`),onCloseClick:close}),/*#__PURE__*/_jsxs(NitroCardContentView,{children:[/*#__PURE__*/_jsxs(Grid,{fullHeight:false,justifyContent:\"between\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Column,{size:1}),/*#__PURE__*/_jsx(Column,{size:10,children:/*#__PURE__*/_jsxs(Flex,{justifyContent:\"between\",alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{fontSize:3,children:LocalizeText('campaign.calendar.heading.day',['number'],[(selectedDay+1).toString()])}),/*#__PURE__*/_jsx(Text,{children:dayMessage(selectedDay)})]}),/*#__PURE__*/_jsx(\"div\",{children:GetSessionDataManager().isModerator&&/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:forceOpen,children:\"Force open\"})})]})}),/*#__PURE__*/_jsx(Column,{size:1})]}),/*#__PURE__*/_jsxs(Flex,{fullHeight:true,gap:2,children:[/*#__PURE__*/_jsx(Flex,{center:true,children:/*#__PURE__*/_jsx(Base,{pointer:true,className:\"campaign-spritesheet prev\",onClick:onClickPrev})}),/*#__PURE__*/_jsx(Column,{center:true,fullWidth:true,children:/*#__PURE__*/_jsx(Grid,{fit:true,columnCount:TOTAL_SHOWN_ITEMS,gap:1,children:[...Array(TOTAL_SHOWN_ITEMS)].map((e,i)=>{const day=index+i;return/*#__PURE__*/_jsx(Column,{overflow:\"hidden\",children:/*#__PURE__*/_jsx(CalendarItemView,{itemId:day,state:getDayState(day),active:selectedDay===day,product:receivedProducts.has(day)?receivedProducts.get(day):null,onClick:onClickItem})},i);})})}),/*#__PURE__*/_jsx(Flex,{center:true,children:/*#__PURE__*/_jsx(Base,{pointer:true,className:\"campaign-spritesheet next\",onClick:onClickNext})})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}