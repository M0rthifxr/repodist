{"ast":null,"code":"import{NitroLogger}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useRef,useState}from'react';import{AddEventLinkTracker,GetConfiguration,NotificationUtilities,RemoveLinkEventTracker}from'../../api';import{Base,NitroCardContentView,NitroCardHeaderView,NitroCardView}from'../../common';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const NEW_LINE_REGEX=/\\n\\r|\\n|\\r/mg;export const NitropediaView=props=>{const[content,setContent]=useState(null);const[header,setHeader]=useState('');const[dimensions,setDimensions]=useState(null);const elementRef=useRef(null);const openPage=useCallback(async link=>{try{const response=await fetch(link);if(!response)return;const text=await response.text();const splitData=text.split(NEW_LINE_REGEX);const line=splitData.shift().split('|');setHeader(line[0]);setDimensions(prevValue=>{if(line[1]&&line[1].split(';').length===2){return{width:parseInt(line[1].split(';')[0]),height:parseInt(line[1].split(';')[1])};}return null;});setContent(splitData.join(''));}catch(error){NitroLogger.error(`Failed to fetch ${link}`);}},[]);const onLinkReceived=useCallback(link=>{const value=link.split('/');if(value.length<2)return;value.shift();openPage(GetConfiguration('habbopages.url')+value.join('/'));},[openPage]);useEffect(()=>{const linkTracker={linkReceived:onLinkReceived,eventUrlPrefix:'habbopages/'};AddEventLinkTracker(linkTracker);return()=>RemoveLinkEventTracker(linkTracker);},[onLinkReceived]);useEffect(()=>{const handle=event=>{if(!(event.target instanceof HTMLAnchorElement))return;event.preventDefault();const link=event.target.href;if(!link||!link.length)return;NotificationUtilities.openUrl(link);};document.addEventListener('click',handle);return()=>{document.removeEventListener('click',handle);};},[]);if(!content)return null;return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitropedia\",theme:\"primary\",style:dimensions?{width:dimensions.width,height:dimensions.height}:{},children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:header,onCloseClick:()=>setContent(null)}),/*#__PURE__*/_jsx(NitroCardContentView,{children:/*#__PURE__*/_jsx(Base,{fit:true,innerRef:elementRef,className:\"text-black\",dangerouslySetInnerHTML:{__html:content}})})]});};","map":null,"metadata":{},"sourceType":"module"}