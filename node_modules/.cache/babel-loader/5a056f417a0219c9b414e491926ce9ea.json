{"ast":null,"code":"import{Point}from'@pixi/math';import{AnimationActionPart}from'./AnimationActionPart';export class AnimationAction{constructor(data){this._id=void 0;this._actionParts=void 0;this._bodyPartOffsets=void 0;this._frameCount=void 0;this._frameIndexes=void 0;this._id=data.id;this._actionParts=new Map();this._bodyPartOffsets=new Map();this._frameCount=0;this._frameIndexes=[];if(data.parts&&data.parts.length>0){for(const part of data.parts){if(!part)continue;const newPart=new AnimationActionPart(part);this._actionParts.set(part.setType,newPart);this._frameCount=Math.max(this._frameCount,newPart.frames.length);}}if(data.offsets&&data.offsets.frames&&data.offsets.frames.length>0){for(const frame of data.offsets.frames){if(!frame)continue;const frameId=frame.id;this._frameCount=Math.max(this._frameCount,frameId);const directions=new Map();this._bodyPartOffsets.set(frameId,directions);if(frame.directions&&frame.directions.length>0){for(const direction of frame.directions){if(!direction)continue;const directionId=direction.id;const offsets=new Map();directions.set(directionId,offsets);if(direction.bodyParts&&direction.bodyParts.length>0){for(const part of direction.bodyParts){if(!part)continue;const partId=part.id;let dx=0;let dy=0;if(part.dx!==undefined)dx=part.dx;if(part.dy!==undefined)dy=part.dy;offsets.set(partId,new Point(dx,dy));}}}}this._frameIndexes.push(frameId);if(frame.repeats!==undefined){let repeats=frame.repeats||0;if(repeats>1)while(--repeats>0)this._frameIndexes.push(frameId);}}}}getPart(type){if(!type)return null;const existing=this._actionParts.get(type);if(!existing)return null;return existing;}getFrameBodyPartOffset(frameId,frameCount,partId){const frameIndex=frameCount%this._frameIndexes.length;const frameNumber=this._frameIndexes[frameIndex];const offsets=this._bodyPartOffsets.get(frameNumber);if(!offsets)return AnimationAction.DEFAULT_OFFSET;const frameOffset=offsets.get(frameId);if(!frameOffset)return AnimationAction.DEFAULT_OFFSET;const offset=frameOffset.get(partId);if(!offset)return AnimationAction.DEFAULT_OFFSET;return offset;}get id(){return this._id;}get parts(){return this._actionParts;}get frameCount(){return this._frameCount;}}AnimationAction.DEFAULT_OFFSET=new Point(0,0);","map":null,"metadata":{},"sourceType":"module"}