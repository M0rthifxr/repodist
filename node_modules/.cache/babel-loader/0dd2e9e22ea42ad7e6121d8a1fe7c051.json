{"ast":null,"code":"import{CheckUserNameMessageComposer,CheckUserNameResultMessageEvent}from'@nitrots/nitro-renderer';import{useCallback,useState}from'react';import{LocalizeText,SendMessageComposer}from'../../../../api';import{UseMessageEventHook}from'../../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const AVAILABLE=0;const TOO_SHORT=2;const TOO_LONG=3;const NOT_VALID=4;const TAKEN_WITH_SUGGESTIONS=5;const DISABLED=6;export const NameChangeInputView=props=>{const{onAction=null}=props;const[newUsername,setNewUsername]=useState('');const[canProceed,setCanProceed]=useState(false);const[isChecking,setIsChecking]=useState(false);const[errorCode,setErrorCode]=useState(null);const[suggestions,setSuggestions]=useState([]);const onCheckUserNameResultMessageEvent=useCallback(event=>{setIsChecking(false);const parser=event.getParser();if(!parser)return;switch(parser.resultCode){case AVAILABLE:setCanProceed(true);break;case TOO_SHORT:setErrorCode('short');break;case TOO_LONG:setErrorCode('long');break;case NOT_VALID:setErrorCode('invalid');break;case TAKEN_WITH_SUGGESTIONS:setSuggestions(parser.nameSuggestions);setErrorCode('taken');break;case DISABLED:setErrorCode('change_not_allowed');}},[]);UseMessageEventHook(CheckUserNameResultMessageEvent,onCheckUserNameResultMessageEvent);const check=useCallback(()=>{if(newUsername==='')return;setCanProceed(false);setSuggestions([]);setErrorCode(null);setIsChecking(true);SendMessageComposer(new CheckUserNameMessageComposer(newUsername));},[newUsername]);const handleUsernameChange=useCallback(username=>{setCanProceed(false);setSuggestions([]);setErrorCode(null);setNewUsername(username);},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column gap-3 h-100\",children:[/*#__PURE__*/_jsx(\"div\",{children:LocalizeText('tutorial.name_change.info.select')}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-sm\",value:newUsername,onChange:e=>handleUsernameChange(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",disabled:newUsername===''||isChecking,onClick:check,children:LocalizeText('tutorial.name_change.check')})]}),!errorCode&&!canProceed&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-muted rounded p-2 text-center\",children:LocalizeText('help.tutorial.name.info')}),errorCode&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-danger rounded p-2 text-center text-white\",children:LocalizeText(`help.tutorial.name.${errorCode}`,['name'],[newUsername])}),canProceed&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-success rounded p-2 text-center text-white\",children:LocalizeText('help.tutorial.name.available',['name'],[newUsername])}),suggestions&&/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-column gap-2\",children:suggestions.map((suggestion,i)=>{return/*#__PURE__*/_jsx(\"div\",{className:\"col bg-muted rounded p-1 cursor-pointer\",onClick:()=>handleUsernameChange(suggestion),children:suggestion},i);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success w-100\",disabled:!canProceed,onClick:()=>onAction('confirmation',newUsername),children:LocalizeText('tutorial.name_change.pick')}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary w-100\",onClick:()=>onAction('close'),children:LocalizeText('cancel')})]})]});};","map":null,"metadata":{},"sourceType":"module"}