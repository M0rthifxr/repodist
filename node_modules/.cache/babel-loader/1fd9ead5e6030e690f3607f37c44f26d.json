{"ast":null,"code":"import{GetMarketplaceConfigurationMessageComposer,MakeOfferMessageComposer,MarketplaceConfigurationEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{LocalizeText,NotificationUtilities,ProductTypeEnum,SendMessageComposer}from'../../../../../../api';import{Base,Button,Column,Grid,LayoutFurniImageView,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../../../../common';import{CatalogPostMarketplaceOfferEvent}from'../../../../../../events';import{useCatalog,UseMessageEventHook,UseUiEvent}from'../../../../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const MarketplacePostOfferView=props=>{const[item,setItem]=useState(null);const[askingPrice,setAskingPrice]=useState(0);const{catalogOptions=null,setCatalogOptions=null}=useCatalog();const{marketplaceConfiguration=null}=catalogOptions;const onMarketplaceConfigurationEvent=useCallback(event=>{const parser=event.getParser();setCatalogOptions(prevValue=>{const newValue={...prevValue};newValue.marketplaceConfiguration=parser;return newValue;});},[setCatalogOptions]);UseMessageEventHook(MarketplaceConfigurationEvent,onMarketplaceConfigurationEvent);const onCatalogPostMarketplaceOfferEvent=useCallback(event=>{setItem(event.item);},[]);UseUiEvent(CatalogPostMarketplaceOfferEvent.POST_MARKETPLACE,onCatalogPostMarketplaceOfferEvent);useEffect(()=>{if(!item||marketplaceConfiguration)return;SendMessageComposer(new GetMarketplaceConfigurationMessageComposer());},[item,marketplaceConfiguration]);useEffect(()=>{if(!item)return;return()=>setAskingPrice(0);},[item]);if(!marketplaceConfiguration||!item)return null;const getFurniTitle=item?LocalizeText(item.isWallItem?'wallItem.name.'+item.type:'roomItem.name.'+item.type):'';const getFurniDescription=item?LocalizeText(item.isWallItem?'wallItem.desc.'+item.type:'roomItem.desc.'+item.type):'';const postItem=()=>{if(!item||askingPrice<=marketplaceConfiguration.minimumPrice)return;NotificationUtilities.confirm(LocalizeText('inventory.marketplace.confirm_offer.info',['furniname','price'],[getFurniTitle,askingPrice.toString()]),()=>{SendMessageComposer(new MakeOfferMessageComposer(askingPrice,item.isWallItem?2:1,item.id));setItem(null);},()=>{setItem(null);},null,null,LocalizeText('inventory.marketplace.confirm_offer.title'));};return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-catalog-layout-marketplace-post-offer\",theme:\"primary\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('inventory.marketplace.make_offer.title'),onCloseClick:event=>setItem(null)}),/*#__PURE__*/_jsx(NitroCardContentView,{overflow:\"hidden\",children:/*#__PURE__*/_jsxs(Grid,{fullHeight:true,children:[/*#__PURE__*/_jsx(Column,{center:true,className:\"bg-muted rounded p-2\",size:4,overflow:\"hidden\",children:/*#__PURE__*/_jsx(LayoutFurniImageView,{productType:item.isWallItem?ProductTypeEnum.WALL:ProductTypeEnum.FLOOR,productClassId:item.type,extraData:item.extra.toString()})}),/*#__PURE__*/_jsxs(Column,{size:8,justifyContent:\"between\",overflow:\"hidden\",children:[/*#__PURE__*/_jsxs(Column,{grow:true,gap:1,children:[/*#__PURE__*/_jsx(Text,{fontWeight:\"bold\",children:getFurniTitle}),/*#__PURE__*/_jsx(Text,{truncate:true,shrink:true,children:getFurniDescription})]}),/*#__PURE__*/_jsxs(Column,{overflow:\"auto\",children:[/*#__PURE__*/_jsx(Text,{italics:true,children:LocalizeText('inventory.marketplace.make_offer.expiration_info',['time'],[marketplaceConfiguration.offerTime.toString()])}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group has-validation\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-control form-control-sm\",type:\"number\",min:0,value:askingPrice,onChange:event=>setAskingPrice(parseInt(event.target.value)),placeholder:LocalizeText('inventory.marketplace.make_offer.price_request')}),(askingPrice<marketplaceConfiguration.minimumPrice||isNaN(askingPrice))&&/*#__PURE__*/_jsx(Base,{className:\"invalid-feedback d-block\",children:LocalizeText('inventory.marketplace.make_offer.min_price',['minprice'],[marketplaceConfiguration.minimumPrice.toString()])}),askingPrice>marketplaceConfiguration.maximumPrice&&!isNaN(askingPrice)&&/*#__PURE__*/_jsx(Base,{className:\"invalid-feedback d-block\",children:LocalizeText('inventory.marketplace.make_offer.max_price',['maxprice'],[marketplaceConfiguration.maximumPrice.toString()])}),!(askingPrice<marketplaceConfiguration.minimumPrice||askingPrice>marketplaceConfiguration.maximumPrice||isNaN(askingPrice))&&/*#__PURE__*/_jsx(Base,{className:\"invalid-feedback d-block\",children:LocalizeText('inventory.marketplace.make_offer.final_price',['commission','finalprice'],[marketplaceConfiguration.commission.toString(),(askingPrice+marketplaceConfiguration.commission).toString()])})]}),/*#__PURE__*/_jsx(Button,{disabled:askingPrice<marketplaceConfiguration.minimumPrice||askingPrice>marketplaceConfiguration.maximumPrice||isNaN(askingPrice),onClick:postItem,children:LocalizeText('inventory.marketplace.make_offer.post')})]})]})]})})]});};","map":null,"metadata":{},"sourceType":"module"}