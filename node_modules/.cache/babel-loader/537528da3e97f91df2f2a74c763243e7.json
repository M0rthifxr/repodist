{"ast":null,"code":"import{EventDispatcher}from'../../core/events/EventDispatcher';import{AvatarRenderEffectLibraryEvent}from'./events/AvatarRenderEffectLibraryEvent';export class EffectAssetDownloadLibrary extends EventDispatcher{constructor(id,revision,assets,assetUrl){super();this._state=void 0;this._libraryName=void 0;this._revision=void 0;this._downloadUrl=void 0;this._assets=void 0;this._animation=void 0;this._state=EffectAssetDownloadLibrary.NOT_LOADED;this._libraryName=id;this._revision=revision;this._downloadUrl=assetUrl;this._assets=assets;this._animation=null;this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName);this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision);const asset=this._assets.getCollection(this._libraryName);if(asset)this._state=EffectAssetDownloadLibrary.LOADED;}downloadAsset(){if(!this._assets||this._state===EffectAssetDownloadLibrary.LOADING||this._state===EffectAssetDownloadLibrary.LOADED)return;const asset=this._assets.getCollection(this._libraryName);if(asset){this._state=EffectAssetDownloadLibrary.LOADED;this.dispatchEvent(new AvatarRenderEffectLibraryEvent(AvatarRenderEffectLibraryEvent.DOWNLOAD_COMPLETE,this));return;}this._state=EffectAssetDownloadLibrary.LOADING;this._assets.downloadAsset(this._downloadUrl,flag=>{if(flag){this._state=EffectAssetDownloadLibrary.LOADED;const collection=this._assets.getCollection(this._libraryName);if(collection)this._animation=collection.data.animations;this.dispatchEvent(new AvatarRenderEffectLibraryEvent(AvatarRenderEffectLibraryEvent.DOWNLOAD_COMPLETE,this));}});}get libraryName(){return this._libraryName;}get animation(){return this._animation;}get isLoaded(){return this._state===EffectAssetDownloadLibrary.LOADED;}}EffectAssetDownloadLibrary.DOWNLOAD_COMPLETE='EADL_DOWNLOAD_COMPLETE';EffectAssetDownloadLibrary.NOT_LOADED=0;EffectAssetDownloadLibrary.LOADING=1;EffectAssetDownloadLibrary.LOADED=2;","map":null,"metadata":{},"sourceType":"module"}