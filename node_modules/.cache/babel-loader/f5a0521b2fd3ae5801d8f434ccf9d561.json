{"ast":null,"code":"import{PetType,RoomObjectCategory,RoomObjectType,RoomObjectVariable}from'@nitrots/nitro-renderer';import{useEffect,useMemo,useState}from'react';import{CreateLinkEvent,GetConfiguration,GetOwnRoomObject,LocalizeText,RoomWidgetUserActionMessage}from'../../../../api';import{useRoomContext}from'../../RoomContext';import{ContextMenuHeaderView}from'../context-menu/ContextMenuHeaderView';import{ContextMenuListItemView}from'../context-menu/ContextMenuListItemView';import{ContextMenuView}from'../context-menu/ContextMenuView';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const _Str_2906=0;const _Str_5818=1;const _Str_5938=2;const _Str_10946=3;export const AvatarInfoWidgetOwnPetView=props=>{const{petData=null,close=null}=props;const[mode,setMode]=useState(_Str_2906);const[respectsLeft,setRespectsLeft]=useState(0);const{roomSession=null,widgetHandler=null}=useRoomContext();const canGiveHandItem=useMemo(()=>{let flag=false;const roomObject=GetOwnRoomObject();if(roomObject){const carryId=roomObject.model.getValue(RoomObjectVariable.FIGURE_CARRY_OBJECT);if(carryId>0&&carryId<999999)flag=true;}return flag;},[]);const processAction=name=>{let messageType=null;let message=null;let hideMenu=true;if(name){switch(name){case'respect':let newRespectsLeft=0;setRespectsLeft(prevValue=>{newRespectsLeft=prevValue-1;return newRespectsLeft;});messageType=RoomWidgetUserActionMessage.RESPECT_PET;if(newRespectsLeft>0)hideMenu=false;break;case'treat':messageType=RoomWidgetUserActionMessage.TREAT_PET;break;case'pass_handitem':messageType=RoomWidgetUserActionMessage.GIVE_CARRY_ITEM_TO_PET;break;case'train'://this.widget._Str_23877();\nbreak;case'pick_up':messageType=RoomWidgetUserActionMessage.PICKUP_PET;break;case'mount':messageType=RoomWidgetUserActionMessage.MOUNT_PET;break;case'toggle_riding_permission':messageType=RoomWidgetUserActionMessage.TOGGLE_PET_RIDING_PERMISSION;break;case'toggle_breeding_permission':messageType=RoomWidgetUserActionMessage.TOGGLE_PET_BREEDING_PERMISSION;break;case'dismount':messageType=RoomWidgetUserActionMessage.DISMOUNT_PET;break;case'saddle_off':messageType=RoomWidgetUserActionMessage.SADDLE_OFF;break;case'breed':if(mode===_Str_2906){// _local_7 = RoomWidgetPetCommandMessage._Str_16282;\n// _local_8 = (\"pet.command.\" + _local_7);\n// _local_9 = _Str_2268.catalog.localization.getLocalization(_local_8);\n// _local_4 = new RoomWidgetPetCommandMessage(RoomWidgetPetCommandMessage.RWPCM_PET_COMMAND, this._Str_594.id, ((this._Str_594.name + \" \") + _local_9));\n}else if(mode===_Str_10946){messageType=RoomWidgetUserActionMessage.REQUEST_BREED_PET;}break;case'harvest':messageType=RoomWidgetUserActionMessage.HARVEST_PET;break;case'revive':messageType=RoomWidgetUserActionMessage.REVIVE_PET;break;case'compost':messageType=RoomWidgetUserActionMessage.COMPOST_PLANT;break;case'buy_saddle':CreateLinkEvent('catalog/open/'+GetConfiguration('catalog.links')['pets.buy_saddle']);break;}if(messageType)message=new RoomWidgetUserActionMessage(messageType,petData.id);if(message)widgetHandler.processWidgetMessage(message);}if(hideMenu)close();};useEffect(()=>{setMode(prevValue=>{if(petData.petType===PetType.MONSTERPLANT)return _Str_10946;else if(petData.saddle&&!petData.rider)return _Str_5818;else if(petData.rider)return _Str_5938;return _Str_2906;});setRespectsLeft(petData.respectsPetLeft);},[petData]);return/*#__PURE__*/_jsxs(ContextMenuView,{objectId:petData.roomIndex,category:RoomObjectCategory.UNIT,userType:RoomObjectType.PET,close:close,collapsable:true,children:[/*#__PURE__*/_jsx(ContextMenuHeaderView,{children:petData.name}),mode===_Str_2906&&/*#__PURE__*/_jsxs(_Fragment,{children:[respectsLeft>0&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('respect'),children:LocalizeText('infostand.button.petrespect',['count'],[respectsLeft.toString()])}),/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('train'),children:LocalizeText('infostand.button.train')}),/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('pick_up'),children:LocalizeText('infostand.button.pickup')}),petData.petType===PetType.HORSE&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('buy_saddle'),children:LocalizeText('infostand.button.buy_saddle')}),[PetType.BEAR,PetType.TERRIER,PetType.CAT,PetType.DOG,PetType.PIG].indexOf(petData.petType)>-1&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('breed'),children:LocalizeText('infostand.button.breed')})]}),mode===_Str_5818&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('mount'),children:LocalizeText('infostand.button.mount')}),/*#__PURE__*/_jsxs(ContextMenuListItemView,{onClick:event=>processAction('toggle_riding_permission'),gap:1,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:!!petData.publiclyRideable,readOnly:true}),LocalizeText('infostand.button.toggle_riding_permission')]}),respectsLeft>0&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('respect'),children:LocalizeText('infostand.button.petrespect',['count'],[respectsLeft.toString()])}),/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('train'),children:LocalizeText('infostand.button.train')}),/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('pick_up'),children:LocalizeText('infostand.button.pickup')}),/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('saddle_off'),children:LocalizeText('infostand.button.saddleoff')})]}),mode===_Str_5938&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('dismount'),children:LocalizeText('infostand.button.dismount')}),respectsLeft>0&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('respect'),children:LocalizeText('infostand.button.petrespect',['count'],[respectsLeft.toString()])})]}),mode===_Str_10946&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('pick_up'),children:LocalizeText('infostand.button.pickup')}),petData.dead&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('revive'),children:LocalizeText('infostand.button.revive')}),roomSession.isRoomOwner&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('compost'),children:LocalizeText('infostand.button.compost')}),!petData.dead&&petData.energy/petData.maximumEnergy<0.98&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('treat'),children:LocalizeText('infostand.button.treat')}),!petData.dead&&petData.level===petData.maximumLevel&&petData.breedable&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(ContextMenuListItemView,{onClick:event=>processAction('toggle_breeding_permission'),gap:1,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:petData.publiclyBreedable,readOnly:true}),LocalizeText('infostand.button.toggle_breeding_permission')]}),/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('breed'),children:LocalizeText('infostand.button.breed')})]})]}),canGiveHandItem&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('pass_hand_item'),children:LocalizeText('infostand.button.pass_hand_item')})]});};","map":null,"metadata":{},"sourceType":"module"}