{"ast":null,"code":"import{RelationshipStatusInfoEvent,RoomSessionFavoriteGroupUpdateEvent,RoomSessionUserBadgesEvent,RoomSessionUserFigureUpdateEvent,UserRelationshipsComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{CloneObject,GetConfiguration,GetGroupInformation,GetSessionDataManager,GetUserProfile,LocalizeText,RoomWidgetChangeMottoMessage,RoomWidgetUpdateInfostandUserEvent,SendMessageComposer}from'../../../../api';import{Base,Column,Flex,LayoutAvatarImageView,LayoutBadgeImageView,Text}from'../../../../common';import{UseEventDispatcherHook,UseMessageEventHook}from'../../../../hooks';import{useRoomContext}from'../../RoomContext';import{InfoStandWidgetUserRelationshipsView}from'./InfoStandWidgetUserRelationshipsView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const InfoStandWidgetUserView=props=>{const{userData=null,setUserData=null,close=null}=props;const[motto,setMotto]=useState(null);const[isEditingMotto,setIsEditingMotto]=useState(false);const[relationships,setRelationships]=useState(null);const{eventDispatcher=null,widgetHandler=null}=useRoomContext();const maxBadgeCount=GetConfiguration('user.badges.max.slots',5);const saveMotto=motto=>{if(!isEditingMotto||motto.length>GetConfiguration('motto.max.length',38))return;widgetHandler.processWidgetMessage(new RoomWidgetChangeMottoMessage(motto));setIsEditingMotto(false);};const onMottoBlur=event=>saveMotto(event.target.value);const onMottoKeyDown=event=>{event.stopPropagation();switch(event.key){case'Enter':saveMotto(event.target.value);return;}};const onRoomSessionUserBadgesEvent=useCallback(event=>{if(!userData||userData.webID!==event.userId)return;setUserData(prevValue=>{const newValue=CloneObject(prevValue);newValue.badges=event.badges;return newValue;});},[userData,setUserData]);UseEventDispatcherHook(RoomSessionUserBadgesEvent.RSUBE_BADGES,eventDispatcher,onRoomSessionUserBadgesEvent);const onRoomSessionUserFigureUpdateEvent=useCallback(event=>{if(!userData||userData.roomIndex!==event.roomIndex)return;setUserData(prevValue=>{const newValue=CloneObject(prevValue);newValue.figure=event.figure;newValue.motto=event.customInfo;newValue.achievementScore=event.activityPoints;return newValue;});},[userData,setUserData]);UseEventDispatcherHook(RoomSessionUserFigureUpdateEvent.USER_FIGURE,eventDispatcher,onRoomSessionUserFigureUpdateEvent);const onRoomSessionFavoriteGroupUpdateEvent=useCallback(event=>{if(!userData||userData.roomIndex!==event.roomIndex)return;setUserData(prevValue=>{const newValue=CloneObject(prevValue);const clearGroup=event.status===-1||event.habboGroupId<=0;newValue.groupId=clearGroup?-1:event.habboGroupId;newValue.groupName=clearGroup?null:event.habboGroupName;newValue.groupBadgeId=clearGroup?null:GetSessionDataManager().getGroupBadge(event.habboGroupId);return newValue;});},[userData,setUserData]);UseEventDispatcherHook(RoomSessionFavoriteGroupUpdateEvent.FAVOURITE_GROUP_UPDATE,eventDispatcher,onRoomSessionFavoriteGroupUpdateEvent);const onUserRelationshipsEvent=useCallback(event=>{const parser=event.getParser();if(!userData||userData.webID!==parser.userId)return;setRelationships(parser);},[userData]);UseMessageEventHook(RelationshipStatusInfoEvent,onUserRelationshipsEvent);useEffect(()=>{setIsEditingMotto(false);setMotto(userData.motto);SendMessageComposer(new UserRelationshipsComposer(userData.webID));return()=>{setIsEditingMotto(false);setMotto(null);setRelationships(null);};},[userData]);if(!userData)return null;return/*#__PURE__*/_jsx(Column,{className:\"nitro-infostand rounded\",children:/*#__PURE__*/_jsxs(Column,{overflow:\"visible\",className:\"container-fluid content-area\",gap:1,children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"between\",children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"i\",{className:\"icon icon-profile-house cursor-pointer\",onClick:event=>GetUserProfile(userData.webID)}),/*#__PURE__*/_jsx(Text,{gfbold:true,variant:\"white\",className:\"infostand-name\",onClick:event=>GetUserProfile(userData.webID),children:userData.name})]}),/*#__PURE__*/_jsx(\"i\",{className:\"infostand-close\",onClick:close})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Column,{fullWidth:true,className:\"body-image infostand-thumb-bg\",onClick:event=>GetUserProfile(userData.webID),children:/*#__PURE__*/_jsx(LayoutAvatarImageView,{figure:userData.figure,direction:4})}),/*#__PURE__*/_jsxs(Column,{grow:true,gap:0,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[0]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[0],showInfo:true})}),/*#__PURE__*/_jsx(Base,{pointer:userData.groupId>0,className:\"badge-image\",onClick:event=>GetGroupInformation(userData.groupId),children:userData.groupId>0&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.groupBadgeId,isGroup:true,showInfo:true,customTitle:userData.groupName})})]}),/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[1]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[1],showInfo:true})}),/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[2]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[2],showInfo:true})})]}),/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[3]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[3],showInfo:true})}),/*#__PURE__*/_jsx(Base,{className:\"badge-image\",children:userData.badges[4]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:userData.badges[4],showInfo:true})})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",className:\"infostand-thumb-bg py-1 px-2\",children:[userData.type!==RoomWidgetUpdateInfostandUserEvent.OWN_USER&&/*#__PURE__*/_jsx(Flex,{grow:true,alignItems:\"center\",className:\"motto-content\",children:/*#__PURE__*/_jsx(Text,{fullWidth:true,pointer:true,wrap:true,textBreak:true,variant:\"white\",children:motto})}),userData.type===RoomWidgetUpdateInfostandUserEvent.OWN_USER&&/*#__PURE__*/_jsxs(Flex,{grow:true,alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(\"i\",{className:\"icon pencil-icon\"}),/*#__PURE__*/_jsxs(Flex,{grow:true,alignItems:\"center\",className:\"motto-content\",children:[!isEditingMotto&&/*#__PURE__*/_jsxs(Text,{fullWidth:true,pointer:true,wrap:true,textBreak:true,variant:\"white\",onClick:event=>setIsEditingMotto(true),children:[motto,\"\\xA0\"]}),isEditingMotto&&/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"motto-input\",maxLength:GetConfiguration('motto.max.length',38),value:motto,onChange:event=>setMotto(event.target.value),onBlur:onMottoBlur,onKeyDown:onMottoKeyDown,autoFocus:true})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{gfbold:true,variant:\"white\",wrap:true,children:LocalizeText('infostand.text.achievement_score')+' '+userData.achievementScore}),userData.carryItem>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"}),/*#__PURE__*/_jsx(Text,{gfbold:true,variant:\"white\",wrap:true,children:LocalizeText('infostand.text.handitem',['item'],[LocalizeText('handitem'+userData.carryItem)])})]})]}),/*#__PURE__*/_jsx(Column,{gap:1,children:/*#__PURE__*/_jsx(InfoStandWidgetUserRelationshipsView,{relationships:relationships})})]})});};","map":null,"metadata":{},"sourceType":"module"}