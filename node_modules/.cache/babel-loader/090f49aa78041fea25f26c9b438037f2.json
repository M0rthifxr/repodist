{"ast":null,"code":"import{Disposable}from'../../core/common/disposable/Disposable';import{CompostPlantMessageComposer,FurnitureMultiStateComposer,HarvestPetMessageComposer,PetMountComposer,PollAnswerComposer,PollRejectComposer,PollStartComposer,RemovePetSaddleComposer,TogglePetBreedingComposer,TogglePetRidingComposer,UsePetProductComposer}from'../communication';import{RoomDoorbellAccessComposer}from'../communication/messages/outgoing/room/access/RoomDoorbellAccessComposer';import{RoomEnterComposer}from'../communication/messages/outgoing/room/access/RoomEnterComposer';import{RoomAmbassadorAlertComposer}from'../communication/messages/outgoing/room/action/RoomAmbassadorAlertComposer';import{RoomBanUserComposer}from'../communication/messages/outgoing/room/action/RoomBanUserComposer';import{RoomGiveRightsComposer}from'../communication/messages/outgoing/room/action/RoomGiveRightsComposer';import{RoomKickUserComposer}from'../communication/messages/outgoing/room/action/RoomKickUserComposer';import{RoomMuteUserComposer}from'../communication/messages/outgoing/room/action/RoomMuteUserComposer';import{RoomTakeRightsComposer}from'../communication/messages/outgoing/room/action/RoomTakeRightsComposer';import{BotRemoveComposer}from'../communication/messages/outgoing/room/engine/BotRemoveComposer';import{PetRemoveComposer}from'../communication/messages/outgoing/room/engine/PetRemoveComposer';import{MoodlightSettingsComposer}from'../communication/messages/outgoing/room/furniture/dimmer/MoodlightSettingsComposer';import{MoodlightSettingsSaveComposer}from'../communication/messages/outgoing/room/furniture/dimmer/MoodlightSettingsSaveComposer';import{MoodlightTogggleStateComposer}from'../communication/messages/outgoing/room/furniture/dimmer/MoodlightTogggleStateComposer';import{OpenPresentComposer}from'../communication/messages/outgoing/room/furniture/presents/OpenPresentComposer';import{RoomUnitChatComposer}from'../communication/messages/outgoing/room/unit/chat/RoomUnitChatComposer';import{RoomUnitChatShoutComposer}from'../communication/messages/outgoing/room/unit/chat/RoomUnitChatShoutComposer';import{RoomUnitChatWhisperComposer}from'../communication/messages/outgoing/room/unit/chat/RoomUnitChatWhisperComposer';import{RoomUnitTypingStartComposer}from'../communication/messages/outgoing/room/unit/chat/RoomUnitTypingStartComposer';import{RoomUnitTypingStopComposer}from'../communication/messages/outgoing/room/unit/chat/RoomUnitTypingStopComposer';import{RoomUnitActionComposer}from'../communication/messages/outgoing/room/unit/RoomUnitActionComposer';import{RoomUnitDanceComposer}from'../communication/messages/outgoing/room/unit/RoomUnitDanceComposer';import{RoomUnitPostureComposer}from'../communication/messages/outgoing/room/unit/RoomUnitPostureComposer';import{RoomUnitSignComposer}from'../communication/messages/outgoing/room/unit/RoomUnitSignComposer';import{UserMottoComposer}from'../communication/messages/outgoing/user/data/UserMottoComposer';import{RoomControllerLevel}from'./enum/RoomControllerLevel';import{RoomTradingLevelEnum}from'./enum/RoomTradingLevelEnum';import{RoomSessionEvent}from'./events/RoomSessionEvent';import{UserDataManager}from'./UserDataManager';export class RoomSession extends Disposable{constructor(){super();this._connection=void 0;this._userData=void 0;this._roomId=void 0;this._password=void 0;this._state=void 0;this._tradeMode=void 0;this._doorMode=void 0;this._allowPets=void 0;this._controllerLevel=void 0;this._ownRoomIndex=void 0;this._isGuildRoom=void 0;this._isRoomOwner=void 0;this._isDecorating=void 0;this._isSpectator=void 0;this._moderationSettings=void 0;this._connection=null;this._userData=new UserDataManager();this._roomId=0;this._password=null;this._state=RoomSessionEvent.CREATED;this._tradeMode=RoomTradingLevelEnum.NO_TRADING;this._doorMode=0;this._controllerLevel=RoomControllerLevel.NONE;this._ownRoomIndex=-1;this._isGuildRoom=false;this._isRoomOwner=false;this._isDecorating=false;this._isSpectator=false;this._moderationSettings=null;}onDispose(){if(this._userData){this._userData.dispose();this._userData=null;}this._connection=null;}setConnection(connection){if(this._connection||!connection)return;this._connection=connection;if(this._userData)this._userData.setConnection(connection);}setControllerLevel(level){if(level>=RoomControllerLevel.NONE&&level<=RoomControllerLevel.MODERATOR){this._controllerLevel=level;return;}this._controllerLevel=RoomControllerLevel.NONE;}setOwnRoomIndex(roomIndex){this._ownRoomIndex=roomIndex;}setRoomOwner(){this._isRoomOwner=true;}start(){if(this._state!==RoomSessionEvent.CREATED||!this._connection)return false;this._state=RoomSessionEvent.STARTED;return this.enterRoom();}enterRoom(){if(!this._connection)return false;this._connection.send(new RoomEnterComposer(this._roomId,this._password));return true;}reset(roomId){if(roomId===this._roomId)return;this._roomId=roomId;}sendChatMessage(text,styleId){this._connection.send(new RoomUnitChatComposer(text,styleId));}sendShoutMessage(text,styleId){this._connection.send(new RoomUnitChatShoutComposer(text,styleId));}sendWhisperMessage(recipientName,text,styleId){this._connection.send(new RoomUnitChatWhisperComposer(recipientName,text,styleId));}sendChatTypingMessage(isTyping){if(isTyping)this._connection.send(new RoomUnitTypingStartComposer());else this._connection.send(new RoomUnitTypingStopComposer());}sendMottoMessage(motto){this._connection.send(new UserMottoComposer(motto));}sendDanceMessage(danceId){this._connection.send(new RoomUnitDanceComposer(danceId));}sendExpressionMessage(expression){this._connection.send(new RoomUnitActionComposer(expression));}sendSignMessage(sign){if(sign<0||sign>17)return;this._connection.send(new RoomUnitSignComposer(sign));}sendPostureMessage(posture){this._connection.send(new RoomUnitPostureComposer(posture));}sendDoorbellApprovalMessage(userName,flag){this._connection.send(new RoomDoorbellAccessComposer(userName,flag));}sendAmbassadorAlertMessage(userId){this._connection.send(new RoomAmbassadorAlertComposer(userId));}sendKickMessage(userId){this._connection.send(new RoomKickUserComposer(userId));}sendMuteMessage(userId,minutes){this._connection.send(new RoomMuteUserComposer(userId,minutes,this._roomId));}sendBanMessage(userId,type){this._connection.send(new RoomBanUserComposer(userId,this._roomId,type));}sendGiveRightsMessage(userId){this._connection.send(new RoomGiveRightsComposer(userId));}sendTakeRightsMessage(userId){this._connection.send(new RoomTakeRightsComposer(userId));}sendPollStartMessage(pollId){this._connection.send(new PollStartComposer(pollId));}sendPollRejectMessage(pollId){this._connection.send(new PollRejectComposer(pollId));}sendPollAnswerMessage(pollId,questionId,answers){this._connection.send(new PollAnswerComposer(pollId,questionId,answers));}updateMoodlightData(id,effectId,color,brightness,apply){let colorString='000000'+color.toString(16).toUpperCase();colorString='#'+colorString.substring(colorString.length-6);this.connection.send(new MoodlightSettingsSaveComposer(id,effectId,colorString,brightness,apply));}toggleMoodlightState(){this.connection.send(new MoodlightTogggleStateComposer());}pickupPet(id){if(!this._connection)return;this._connection.send(new PetRemoveComposer(id));}pickupBot(id){if(!this._connection)return;this._connection.send(new BotRemoveComposer(id));}requestMoodlightSettings(){if(!this._connection)return;this._connection.send(new MoodlightSettingsComposer());}openGift(objectId){this._connection.send(new OpenPresentComposer(objectId));}mountPet(id){this._connection.send(new PetMountComposer(id,true));}dismountPet(id){this._connection.send(new PetMountComposer(id,false));}usePetProduct(itemId,petId){this._connection.send(new UsePetProductComposer(itemId,petId));}removePetSaddle(id){this._connection.send(new RemovePetSaddleComposer(id));}togglePetBreeding(id){this._connection.send(new TogglePetBreedingComposer(id));}togglePetRiding(id){this._connection.send(new TogglePetRidingComposer(id));}useMultistateItem(id){this._connection.send(new FurnitureMultiStateComposer(id));}harvestPet(id){this._connection.send(new HarvestPetMessageComposer(id));}compostPlant(id){this._connection.send(new CompostPlantMessageComposer(id));}get connection(){return this._connection;}get userDataManager(){return this._userData;}get roomId(){return this._roomId;}set roomId(roomId){this._roomId=roomId;}get password(){return this._password;}set password(password){this._password=password;}get state(){return this._state;}get _Str_7411(){return true;}get tradeMode(){return this._tradeMode;}set tradeMode(mode){this._tradeMode=mode;}get doorMode(){return this._doorMode;}set doorMode(mode){this._doorMode=mode;}get allowPets(){return this._allowPets;}set allowPets(flag){this._allowPets=flag;}get controllerLevel(){return this._controllerLevel;}get ownRoomIndex(){return this._ownRoomIndex;}get isGuildRoom(){return this._isGuildRoom;}set isGuildRoom(flag){this._isGuildRoom=flag;}get isRoomOwner(){return this._isRoomOwner;}get isDecorating(){return this._isDecorating;}set isDecorating(flag){this._isDecorating=flag;}get isSpectator(){return this._isSpectator;}set isSpectator(flag){this._isSpectator=flag;}get moderationSettings(){return this._moderationSettings;}set moderationSettings(parser){this._moderationSettings=parser;}}","map":null,"metadata":{},"sourceType":"module"}