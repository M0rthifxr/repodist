{"ast":null,"code":"import{FurnitureStackHeightComposer,FurnitureStackHeightEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import ReactSlider from'react-slider';import{LocalizeText,RoomWidgetUpdateCustomStackHeightEvent,SendMessageComposer}from'../../../../../api';import{Button,Column,Flex,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../../../common';import{UseEventDispatcherHook,UseMessageEventHook}from'../../../../../hooks';import{useRoomContext}from'../../../RoomContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const MAX_HEIGHT=40;export const FurnitureCustomStackHeightView=props=>{const[objectId,setObjectId]=useState(-1);const[height,setHeight]=useState(0);const[pendingHeight,setPendingHeight]=useState(-1);const{eventDispatcher=null}=useRoomContext();const close=()=>{setObjectId(-1);setHeight(0);};const updateHeight=useCallback(function(height){let fromServer=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!height)height=0;height=Math.abs(height);if(!fromServer)height>MAX_HEIGHT&&(height=MAX_HEIGHT);setHeight(parseFloat(height.toFixed(2)));if(!fromServer)setPendingHeight(height*100);},[]);const onRoomWidgetUpdateCustomStackHeightEvent=useCallback(event=>{switch(event.type){case RoomWidgetUpdateCustomStackHeightEvent.UPDATE_CUSTOM_STACK_HEIGHT:{setObjectId(event.objectId);updateHeight(event.height,true);}}},[updateHeight]);UseEventDispatcherHook(RoomWidgetUpdateCustomStackHeightEvent.UPDATE_CUSTOM_STACK_HEIGHT,eventDispatcher,onRoomWidgetUpdateCustomStackHeightEvent);const onFurnitureStackHeightEvent=useCallback(event=>{const parser=event.getParser();if(objectId!==parser.furniId)return;updateHeight(parser.height,true);},[objectId,updateHeight]);UseMessageEventHook(FurnitureStackHeightEvent,onFurnitureStackHeightEvent);const sendUpdate=useCallback(height=>{SendMessageComposer(new FurnitureStackHeightComposer(objectId,~~height));},[objectId]);useEffect(()=>{if(objectId===-1||pendingHeight===-1)return;const timeout=setTimeout(()=>sendUpdate(~~pendingHeight),10);return()=>clearTimeout(timeout);},[objectId,pendingHeight,sendUpdate]);if(objectId===-1)return null;return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-widget-custom-stack-height\",theme:\"primary\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('widget.custom.stack.height.title'),onCloseClick:close}),/*#__PURE__*/_jsxs(NitroCardContentView,{justifyContent:\"between\",children:[/*#__PURE__*/_jsx(Text,{children:LocalizeText('widget.custom.stack.height.text')}),/*#__PURE__*/_jsxs(Flex,{gap:2,children:[/*#__PURE__*/_jsx(ReactSlider,{className:\"nitro-slider\",min:0,max:MAX_HEIGHT,step:0.01,value:height,onChange:event=>updateHeight(event),renderThumb:(props,state)=>/*#__PURE__*/_jsx(\"div\",{...props,children:state.valueNow})}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:0,max:MAX_HEIGHT,value:height,onChange:event=>updateHeight(parseFloat(event.target.value))})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Button,{onClick:event=>sendUpdate(-100),children:LocalizeText('furniture.above.stack')}),/*#__PURE__*/_jsx(Button,{onClick:event=>sendUpdate(0),children:LocalizeText('furniture.floor.level')})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}