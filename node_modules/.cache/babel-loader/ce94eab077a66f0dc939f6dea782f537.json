{"ast":null,"code":"import{RelationshipStatusInfoEvent,RoomEngineObjectEvent,RoomObjectCategory,RoomObjectType,UserCurrentBadgesComposer,UserCurrentBadgesEvent,UserProfileEvent,UserRelationshipsComposer}from'@nitrots/nitro-renderer';import{useCallback,useState}from'react';import{CreateLinkEvent,GetRoomSession,GetSessionDataManager,GetUserProfile,LocalizeText,SendMessageComposer}from'../../api';import{Column,Flex,Grid,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../common';import{UseMessageEventHook,UseRoomEngineEvent}from'../../hooks';import{BadgesContainerView}from'./views/BadgesContainerView';import{FriendsContainerView}from'./views/FriendsContainerView';import{GroupsContainerView}from'./views/GroupsContainerView';import{UserContainerView}from'./views/UserContainerView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const UserProfileView=props=>{const[userProfile,setUserProfile]=useState(null);const[userBadges,setUserBadges]=useState([]);const[userRelationships,setUserRelationships]=useState(null);const onClose=()=>{setUserProfile(null);setUserBadges([]);setUserRelationships(null);};const onLeaveGroup=useCallback(()=>{if(!userProfile||userProfile.id!==GetSessionDataManager().userId)return;GetUserProfile(userProfile.id);},[userProfile]);const onUserCurrentBadgesEvent=useCallback(event=>{const parser=event.getParser();if(!userProfile||parser.userId!==userProfile.id)return;setUserBadges(parser.badges);},[userProfile]);UseMessageEventHook(UserCurrentBadgesEvent,onUserCurrentBadgesEvent);const onUserRelationshipsEvent=useCallback(event=>{const parser=event.getParser();if(!userProfile||parser.userId!==userProfile.id)return;setUserRelationships(parser);},[userProfile]);UseMessageEventHook(RelationshipStatusInfoEvent,onUserRelationshipsEvent);const onUserProfileEvent=useCallback(event=>{const parser=event.getParser();let isSameProfile=false;setUserProfile(prevValue=>{if(prevValue&&prevValue.id)isSameProfile=prevValue.id===parser.id;return parser;});if(!isSameProfile){setUserBadges([]);setUserRelationships(null);}SendMessageComposer(new UserCurrentBadgesComposer(parser.id));SendMessageComposer(new UserRelationshipsComposer(parser.id));},[]);UseMessageEventHook(UserProfileEvent,onUserProfileEvent);const onRoomEngineObjectEvent=useCallback(event=>{if(!userProfile)return;if(event.category!==RoomObjectCategory.UNIT)return;const userData=GetRoomSession().userDataManager.getUserDataByIndex(event.objectId);if(userData.type!==RoomObjectType.USER)return;GetUserProfile(userData.webID);},[userProfile]);UseRoomEngineEvent(RoomEngineObjectEvent.SELECTED,onRoomEngineObjectEvent);if(!userProfile)return null;return/*#__PURE__*/_jsxs(NitroCardView,{uniqueKey:\"nitro-user-profile\",theme:\"primary\",className:\"user-profile\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('extendedprofile.caption'),onCloseClick:onClose}),/*#__PURE__*/_jsxs(NitroCardContentView,{overflow:\"hidden\",children:[/*#__PURE__*/_jsxs(Grid,{fullHeight:false,gap:2,children:[/*#__PURE__*/_jsxs(Column,{size:7,gap:1,className:\"user-container pe-2\",children:[/*#__PURE__*/_jsx(UserContainerView,{userProfile:userProfile}),userProfile.id===GetSessionDataManager().userId&&/*#__PURE__*/_jsxs(Flex,{className:\"p-0\",children:[/*#__PURE__*/_jsx(Text,{small:true,underline:true,className:\"cursor-pointer\",onClick:event=>CreateLinkEvent('avatar-editor/toggle'),children:\"Change Clothes\"}),/*#__PURE__*/_jsx(Text,{className:\"cursor-pointer badge-text\",small:true,underline:true,onClick:event=>CreateLinkEvent('inventory/toggle'),children:\"Change Badges\"})]}),/*#__PURE__*/_jsx(Grid,{columnCount:5,fullHeight:true,className:\"profile-grey-bg p-1\",children:/*#__PURE__*/_jsx(BadgesContainerView,{fullWidth:true,center:true,badges:userBadges})})]}),/*#__PURE__*/_jsx(Column,{size:5,children:userRelationships&&/*#__PURE__*/_jsx(FriendsContainerView,{relationships:userRelationships,friendsCount:userProfile.friendsCount})})]}),/*#__PURE__*/_jsx(Flex,{alignItems:\"center\",className:\"rooms-button-container px-2 py-1\",children:/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,onClick:event=>CreateLinkEvent(`navigator/search/hotel_view/owner:${userProfile.username}`),children:[/*#__PURE__*/_jsx(\"i\",{className:\"icon icon-rooms\"}),/*#__PURE__*/_jsx(Text,{bold:true,small:true,underline:true,pointer:true,children:LocalizeText('extendedprofile.rooms')})]})}),/*#__PURE__*/_jsx(GroupsContainerView,{fullWidth:true,itsMe:userProfile.id===GetSessionDataManager().userId,groups:userProfile.groups,onLeaveGroup:onLeaveGroup})]})]});};","map":null,"metadata":{},"sourceType":"module"}