{"ast":null,"code":"import{PetType,RoomControllerLevel,RoomObjectCategory,RoomObjectType,RoomObjectVariable}from'@nitrots/nitro-renderer';import{useEffect,useMemo,useState}from'react';import{GetOwnRoomObject,GetSessionDataManager,LocalizeText,RoomWidgetUserActionMessage}from'../../../../api';import{useRoomContext}from'../../RoomContext';import{ContextMenuHeaderView}from'../context-menu/ContextMenuHeaderView';import{ContextMenuListItemView}from'../context-menu/ContextMenuListItemView';import{ContextMenuView}from'../context-menu/ContextMenuView';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const _Str_2906=0;const _Str_5818=1;const _Str_5938=2;const _Str_13388=3;export const AvatarInfoWidgetPetView=props=>{const{petData=null,close=null}=props;const[mode,setMode]=useState(_Str_2906);const[respectsLeft,setRespectsLeft]=useState(0);const{roomSession=null,widgetHandler=null}=useRoomContext();const canPickUp=useMemo(()=>{return roomSession.isRoomOwner||roomSession.controllerLevel>=RoomControllerLevel.GUEST||GetSessionDataManager().isModerator;},[roomSession]);const canGiveHandItem=useMemo(()=>{let flag=false;const roomObject=GetOwnRoomObject();if(roomObject){const carryId=roomObject.model.getValue(RoomObjectVariable.FIGURE_CARRY_OBJECT);if(carryId>0&&carryId<999999)flag=true;}return flag;},[]);const processAction=name=>{let messageType=null;let message=null;let hideMenu=true;if(name){switch(name){case'respect':let newRespectsLeft=0;setRespectsLeft(prevValue=>{newRespectsLeft=prevValue-1;return newRespectsLeft;});messageType=RoomWidgetUserActionMessage.RESPECT_PET;if(newRespectsLeft>0)hideMenu=false;break;case'treat':messageType=RoomWidgetUserActionMessage.TREAT_PET;break;case'pass_handitem':messageType=RoomWidgetUserActionMessage.GIVE_CARRY_ITEM_TO_PET;break;case'pick_up':messageType=RoomWidgetUserActionMessage.PICKUP_PET;break;case'mount':messageType=RoomWidgetUserActionMessage.MOUNT_PET;break;case'dismount':messageType=RoomWidgetUserActionMessage.DISMOUNT_PET;break;}if(messageType)message=new RoomWidgetUserActionMessage(messageType,petData.id);if(message)widgetHandler.processWidgetMessage(message);}if(hideMenu)close();};useEffect(()=>{setMode(prevValue=>{if(petData.petType===PetType.MONSTERPLANT)return _Str_13388;else if(petData.saddle&&!petData.rider)return _Str_5818;else if(petData.rider)return _Str_5938;return _Str_2906;});setRespectsLeft(petData.respectsPetLeft);},[petData]);return/*#__PURE__*/_jsxs(ContextMenuView,{objectId:petData.roomIndex,category:RoomObjectCategory.UNIT,userType:RoomObjectType.PET,close:close,collapsable:true,children:[/*#__PURE__*/_jsx(ContextMenuHeaderView,{children:petData.name}),mode===_Str_2906&&respectsLeft>0&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('respect'),children:LocalizeText('infostand.button.petrespect',['count'],[respectsLeft.toString()])}),mode===_Str_5818&&/*#__PURE__*/_jsxs(_Fragment,{children:[!!petData.publiclyRideable&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('mount'),children:LocalizeText('infostand.button.mount')}),respectsLeft>0&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('respect'),children:LocalizeText('infostand.button.petrespect',['count'],[respectsLeft.toString()])})]}),mode===_Str_5938&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('dismount'),children:LocalizeText('infostand.button.dismount')}),respectsLeft>0&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('respect'),children:LocalizeText('infostand.button.petrespect',['count'],[respectsLeft.toString()])})]}),mode===_Str_13388&&!petData.dead&&petData.energy/petData.maximumEnergy<0.98&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('treat'),children:LocalizeText('infostand.button.treat')}),canPickUp&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('pick_up'),children:LocalizeText('infostand.button.pickup')}),canGiveHandItem&&/*#__PURE__*/_jsx(ContextMenuListItemView,{onClick:event=>processAction('pass_hand_item'),children:LocalizeText('infostand.button.pass_hand_item')})]});};","map":null,"metadata":{},"sourceType":"module"}