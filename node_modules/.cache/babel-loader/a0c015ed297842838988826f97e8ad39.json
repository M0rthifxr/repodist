{"ast":null,"code":"import{AvatarEditorUtilities}from'./AvatarEditorUtilities';export class FigureData{constructor(){this._data=void 0;this._colors=void 0;this._gender='M';this._direction=FigureData.DEFAULT_DIRECTION;this._avatarEffectType=-1;this._notifier=null;}loadAvatarData(figureString,gender){this._data=new Map();this._colors=new Map();this._gender=gender;this.parseFigureString(figureString);this.updateView();}parseFigureString(figure){if(!figure)return;const sets=figure.split('.');if(!sets||!sets.length)return;for(const set of sets){const parts=set.split('-');if(!parts.length)continue;const setType=parts[0];const setId=parseInt(parts[1]);const colorIds=[];let offset=2;while(offset<parts.length){colorIds.push(parseInt(parts[offset]));offset++;}if(!colorIds.length)colorIds.push(0);this.savePartSetId(setType,setId,false);this.savePartSetColourId(setType,colorIds,false);}}getPartSetId(setType){const existing=this._data.get(setType);if(existing!==undefined)return existing;return-1;}getColorIds(setType){const existing=this._colors.get(setType);if(existing!==undefined)return existing;return[AvatarEditorUtilities.avatarSetFirstSelectableColor(setType)];}getFigureString(){let figureString='';const setParts=[];for(const[setType,setId]of this._data.entries()){const colorIds=this._colors.get(setType);let setPart=setType+'-'+setId;if(colorIds&&colorIds.length){let i=0;while(i<colorIds.length){setPart=setPart+('-'+colorIds[i]);i++;}}setParts.push(setPart);}let i=0;while(i<setParts.length){figureString=figureString+setParts[i];if(i<setParts.length-1)figureString=figureString+'.';i++;}return figureString;}savePartData(setType,partId,colorIds){let update=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;this.savePartSetId(setType,partId,update);this.savePartSetColourId(setType,colorIds,update);}savePartSetId(setType,partId){let update=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;switch(setType){case FigureData.FACE:case FigureData.HAIR:case FigureData.HAT:case FigureData.HEAD_ACCESSORIES:case FigureData.EYE_ACCESSORIES:case FigureData.FACE_ACCESSORIES:case FigureData.SHIRT:case FigureData.JACKET:case FigureData.CHEST_ACCESSORIES:case FigureData.CHEST_PRINTS:case FigureData.TROUSERS:case FigureData.SHOES:case FigureData.TROUSER_ACCESSORIES:if(partId>=0){this._data.set(setType,partId);}else{this._data.delete(setType);}break;}if(update)this.updateView();}savePartSetColourId(setType,colorIds){let update=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;switch(setType){case FigureData.FACE:case FigureData.HAIR:case FigureData.HAT:case FigureData.HEAD_ACCESSORIES:case FigureData.EYE_ACCESSORIES:case FigureData.FACE_ACCESSORIES:case FigureData.SHIRT:case FigureData.JACKET:case FigureData.CHEST_ACCESSORIES:case FigureData.CHEST_PRINTS:case FigureData.TROUSERS:case FigureData.SHOES:case FigureData.TROUSER_ACCESSORIES:this._colors.set(setType,colorIds);break;}if(update)this.updateView();}getFigureStringWithFace(k){let override=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;let figureString='';const setTypes=[FigureData.FACE];const figureSets=[];for(const setType of setTypes){const colors=this._colors.get(setType);if(!colors)continue;let setId=this._data.get(setType);if(setType===FigureData.FACE&&override)setId=k;let figureSet=setType+'-'+setId;if(setId>=0){let i=0;while(i<colors.length){figureSet=figureSet+('-'+colors[i]);i++;}}figureSets.push(figureSet);}let i=0;while(i<figureSets.length){figureString=figureString+figureSets[i];if(i<figureSets.length-1)figureString=figureString+'.';i++;}return figureString;}updateView(){if(this.notify)this.notify();}get gender(){return this._gender;}get direction(){return this._direction;}set direction(direction){this._direction=direction;this.updateView();}set avatarEffectType(k){this._avatarEffectType=k;}get avatarEffectType(){return this._avatarEffectType;}get notify(){return this._notifier;}set notify(notifier){this._notifier=notifier;}}FigureData.DEFAULT_DIRECTION=4;FigureData.MALE='M';FigureData.FEMALE='F';FigureData.UNISEX='U';FigureData.SCALE='h';FigureData.STD='std';FigureData.DEFAULT_FRAME='0';FigureData.FACE='hd';FigureData.HAIR='hr';FigureData.HAT='ha';FigureData.HEAD_ACCESSORIES='he';FigureData.EYE_ACCESSORIES='ea';FigureData.FACE_ACCESSORIES='fa';FigureData.JACKET='cc';FigureData.SHIRT='ch';FigureData.CHEST_ACCESSORIES='ca';FigureData.CHEST_PRINTS='cp';FigureData.TROUSERS='lg';FigureData.SHOES='sh';FigureData.TROUSER_ACCESSORIES='wa';FigureData.SET_TYPES=[FigureData.FACE,FigureData.HAIR,FigureData.HAT,FigureData.HEAD_ACCESSORIES,FigureData.EYE_ACCESSORIES,FigureData.FACE_ACCESSORIES,FigureData.JACKET,FigureData.SHIRT,FigureData.CHEST_ACCESSORIES,FigureData.CHEST_PRINTS,FigureData.TROUSERS,FigureData.SHOES,FigureData.TROUSERS];","map":null,"metadata":{},"sourceType":"module"}