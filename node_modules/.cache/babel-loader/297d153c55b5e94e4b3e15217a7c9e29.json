{"ast":null,"code":"export class CategoryData{constructor(name,partItems,colorItems){this._name=void 0;this._parts=void 0;this._palettes=void 0;this._selectedPartIndex=-1;this._paletteIndexes=void 0;this._name=name;this._parts=partItems;this._palettes=colorItems;this._selectedPartIndex=-1;}static defaultColorId(palettes,clubLevel){if(!palettes||!palettes.length)return-1;let i=0;while(i<palettes.length){const colorItem=palettes[i];if(colorItem.partColor&&colorItem.partColor.clubLevel<=clubLevel){return colorItem.partColor.id;}i++;}return-1;}init(){for(const part of this._parts){if(!part)continue;part.init();}}dispose(){if(this._parts){for(const part of this._parts)part.dispose();this._parts=null;}if(this._palettes){for(const palette of this._palettes)for(const colorItem of palette)colorItem.dispose();this._palettes=null;}this._selectedPartIndex=-1;this._paletteIndexes=null;}selectPartId(partId){if(!this._parts)return;let i=0;while(i<this._parts.length){const partItem=this._parts[i];if(partItem.id===partId){this.selectPartIndex(i);return;}i++;}}selectColorIds(colorIds){if(!colorIds||!this._palettes)return;this._paletteIndexes=new Array(colorIds.length);let i=0;while(i<this._palettes.length){const palette=this.getPalette(i);if(palette){let colorId=0;if(colorIds.length>i){colorId=colorIds[i];}else{const colorItem=palette[0];if(colorItem&&colorItem.partColor)colorId=colorItem.partColor.id;}let j=0;while(j<palette.length){const colorItem=palette[j];if(colorItem.partColor.id===colorId){this._paletteIndexes[i]=j;colorItem.isSelected=true;}else{colorItem.isSelected=false;}j++;}}i++;}this.updatePartColors();}selectPartIndex(partIndex){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const partItem=this._parts[this._selectedPartIndex];if(partItem)partItem.isSelected=false;}if(this._parts.length>partIndex){const partItem=this._parts[partIndex];if(partItem){partItem.isSelected=true;this._selectedPartIndex=partIndex;return partItem;}}return null;}selectColorIndex(colorIndex,paletteId){const palette=this.getPalette(paletteId);if(!palette)return null;if(palette.length<=colorIndex)return null;this.deselectColorIndex(this._paletteIndexes[paletteId],paletteId);this._paletteIndexes[paletteId]=colorIndex;const colorItem=palette[colorIndex];if(!colorItem)return null;colorItem.isSelected=true;this.updatePartColors();return colorItem;}getCurrentColorIndex(k){return this._paletteIndexes[k];}deselectColorIndex(colorIndex,paletteIndex){const palette=this.getPalette(paletteIndex);if(!palette)return;if(palette.length<=colorIndex)return;const colorItem=palette[colorIndex];if(!colorItem)return;colorItem.isSelected=false;}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length)return null;if(!this._palettes||!this._palettes.length)return null;const palette=this._palettes[0];if(!palette||!palette.length)return null;const colorItem=palette[0];if(!colorItem||!colorItem.partColor)return null;const colorId=colorItem.partColor.id;const colorIds=[];let i=0;while(i<this._paletteIndexes.length){const paletteSet=this._palettes[i];if(!(!paletteSet||paletteSet.length<=i)){if(paletteSet.length>this._paletteIndexes[i]){const color=paletteSet[this._paletteIndexes[i]];if(color&&color.partColor){colorIds.push(color.partColor.id);}else{colorIds.push(colorId);}}else{colorIds.push(colorId);}}i++;}const partItem=this.getCurrentPart();if(!partItem)return null;return colorIds.slice(0,Math.max(partItem.maxColorIndex,1));}getSelectedColors(){const partColors=[];let i=0;while(i<this._paletteIndexes.length){const colorItem=this.getSelectedColor(i);if(colorItem){partColors.push(colorItem.partColor);}else{partColors.push(null);}i++;}return partColors;}getSelectedColor(paletteId){const palette=this.getPalette(paletteId);if(!palette||palette.length<=this._paletteIndexes[paletteId])return null;return palette[this._paletteIndexes[paletteId]];}getSelectedColorId(paletteId){const colorItem=this.getSelectedColor(paletteId);if(colorItem&&colorItem.partColor)return colorItem.partColor.id;return 0;}getPalette(paletteId){if(!this._paletteIndexes||!this._palettes||this._palettes.length<=paletteId){return null;}return this._palettes[paletteId];}getCurrentPart(){return this._parts[this._selectedPartIndex];}updatePartColors(){const partColors=this.getSelectedColors();for(const partItem of this._parts){if(partItem)partItem.partColors=partColors;}}hasClubSelectionsOverLevel(level){let hasInvalidSelections=false;const partColors=this.getSelectedColors();if(partColors){let i=0;while(i<partColors.length){const partColor=partColors[i];if(partColor&&partColor.clubLevel>level)hasInvalidSelections=true;i++;}}const partItem=this.getCurrentPart();if(partItem&&partItem.partSet){const partSet=partItem.partSet;if(partSet&&partSet.clubLevel>level)hasInvalidSelections=true;}return hasInvalidSelections;}hasInvalidSelectedItems(ownedItems){const part=this.getCurrentPart();if(!part)return false;const partSet=part.partSet;if(!partSet||!partSet.isSellable)return;return ownedItems.indexOf(partSet.id)>-1;}stripClubItemsOverLevel(level){const partItem=this.getCurrentPart();if(partItem&&partItem.partSet){const partSet=partItem.partSet;if(partSet.clubLevel>level){const newPartItem=this.selectPartIndex(0);if(newPartItem&&!newPartItem.partSet)this.selectPartIndex(1);return true;}}return false;}stripClubColorsOverLevel(level){const colorIds=[];const partColors=this.getSelectedColors();const colorItems=this.getPalette(0);let didStrip=false;const colorId=CategoryData.defaultColorId(colorItems,level);if(colorId===-1)return false;let i=0;while(i<partColors.length){const partColor=partColors[i];if(!partColor){colorIds.push(colorId);didStrip=true;}else{if(partColor.clubLevel>level){colorIds.push(colorId);didStrip=true;}else{colorIds.push(partColor.id);}}i++;}if(didStrip)this.selectColorIds(colorIds);return didStrip;}// public stripInvalidSellableItems(k:IHabboInventory): boolean\n// {\n//     var _local_3:IFigurePartSet;\n//     var _local_4:AvatarEditorGridPartItem;\n//     var _local_2:AvatarEditorGridPartItem = this._Str_6315();\n//     if (((_local_2) && (_local_2.partSet)))\n//     {\n//         _local_3 = _local_2.partSet;\n//         if (((_local_3.isSellable) && (!(k._Str_14439(_local_3.id)))))\n//         {\n//             _local_4 = this._Str_8066(0);\n//             if (((!(_local_4 == null)) && (_local_4.partSet == null)))\n//             {\n//                 this._Str_8066(1);\n//             }\n//             return true;\n//         }\n//     }\n//     return false;\n// }\nget name(){return this._name;}get parts(){return this._parts;}get selectedPartIndex(){return this._selectedPartIndex;}}","map":null,"metadata":{},"sourceType":"module"}