{"ast":null,"code":"import{GetModeratorRoomInfoMessageComposer,ModerateRoomMessageComposer,ModeratorActionMessageComposer,ModeratorRoomInfoEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{SendMessageComposer,TryVisitRoom}from'../../../../api';import{Button,Column,DraggableWindowPosition,Flex,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../../common';import{ModToolsOpenRoomChatlogEvent}from'../../../../events/mod-tools/ModToolsOpenRoomChatlogEvent';import{DispatchUiEvent,UseMessageEventHook}from'../../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const ModToolsRoomView=props=>{const{roomId=null,onCloseClick=null}=props;const[infoRequested,setInfoRequested]=useState(false);const[loadedRoomId,setLoadedRoomId]=useState(null);const[name,setName]=useState(null);const[desc,setDesc]=useState(null);const[ownerId,setOwnerId]=useState(null);const[ownerName,setOwnerName]=useState(null);const[ownerInRoom,setOwnerInRoom]=useState(false);const[usersInRoom,setUsersInRoom]=useState(0);//form data\nconst[kickUsers,setKickUsers]=useState(false);const[lockRoom,setLockRoom]=useState(false);const[changeRoomName,setChangeRoomName]=useState(false);const[message,setMessage]=useState('');const onModtoolRoomInfoEvent=useCallback(event=>{const parser=event.getParser();if(!parser||parser.data.flatId!==roomId)return;setLoadedRoomId(parser.data.flatId);setName(parser.data.room.name);setDesc(parser.data.room.desc);setOwnerId(parser.data.ownerId);setOwnerName(parser.data.ownerName);setOwnerInRoom(parser.data.ownerInRoom);setUsersInRoom(parser.data.userCount);},[roomId]);UseMessageEventHook(ModeratorRoomInfoEvent,onModtoolRoomInfoEvent);const handleClick=useCallback((action,value)=>{if(!action)return;switch(action){case'alert_only':if(message.trim().length===0)return;SendMessageComposer(new ModeratorActionMessageComposer(ModeratorActionMessageComposer.ACTION_ALERT,message,''));SendMessageComposer(new ModerateRoomMessageComposer(roomId,lockRoom?1:0,changeRoomName?1:0,kickUsers?1:0));return;case'send_message':if(message.trim().length===0)return;SendMessageComposer(new ModeratorActionMessageComposer(ModeratorActionMessageComposer.ACTION_MESSAGE,message,''));SendMessageComposer(new ModerateRoomMessageComposer(roomId,lockRoom?1:0,changeRoomName?1:0,kickUsers?1:0));return;}},[changeRoomName,kickUsers,lockRoom,message,roomId]);useEffect(()=>{if(infoRequested)return;SendMessageComposer(new GetModeratorRoomInfoMessageComposer(roomId));setInfoRequested(true);},[roomId,infoRequested,setInfoRequested]);return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-mod-tools-room\",theme:\"modtool-windows\",windowPosition:DraggableWindowPosition.TOP_CENTER,children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:'Room Info',onCloseClick:event=>onCloseClick()}),/*#__PURE__*/_jsxs(NitroCardContentView,{className:\"text-black\",children:[/*#__PURE__*/_jsxs(Column,{gap:0,className:\"mod-content p-2\",children:[/*#__PURE__*/_jsx(Text,{gfbold:true,children:name}),/*#__PURE__*/_jsx(Text,{children:desc})]}),/*#__PURE__*/_jsxs(Flex,{gap:2,className:\"mod-content p-2\",children:[/*#__PURE__*/_jsxs(Column,{justifyContent:\"center\",grow:true,gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{gfbold:true,className:\"\",children:\"Room Owner:\"}),/*#__PURE__*/_jsx(Text,{underline:true,pointer:true,truncate:true,children:ownerName})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(Text,{gfbold:true,className:\"\",children:\"Users in room:\"}),/*#__PURE__*/_jsx(Text,{children:usersInRoom})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(Text,{gfbold:true,className:\"\",children:\"Owner in room:\"}),/*#__PURE__*/_jsx(Text,{children:ownerInRoom?'Yes':'No'})]})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Button,{onClick:event=>TryVisitRoom(roomId),children:\"Visit Room\"}),/*#__PURE__*/_jsx(Button,{onClick:event=>DispatchUiEvent(new ModToolsOpenRoomChatlogEvent(roomId)),children:\"Chatlog\"})]})]}),/*#__PURE__*/_jsxs(Column,{className:\"mod-content p-2\",gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:kickUsers,onChange:event=>setKickUsers(event.target.checked)}),/*#__PURE__*/_jsx(Text,{children:\"Kick everyone out\"})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:lockRoom,onChange:event=>setLockRoom(event.target.checked)}),/*#__PURE__*/_jsx(Text,{children:\"Enable the doorbell\"})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:changeRoomName,onChange:event=>setChangeRoomName(event.target.checked)}),/*#__PURE__*/_jsx(Text,{children:\"Change room name\"})]})]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control message-input p-1\",placeholder:\"Type a mandatory message to the users in this text box...\",value:message,onChange:event=>setMessage(event.target.value)}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"between\",children:[/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:event=>handleClick('send_message'),children:\"Send Caution\"}),/*#__PURE__*/_jsx(Button,{onClick:event=>handleClick('alert_only'),children:\"Send Alert only\"})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}