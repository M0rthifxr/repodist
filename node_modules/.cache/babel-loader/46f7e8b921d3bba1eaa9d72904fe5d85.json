{"ast":null,"code":"import{GetGuestRoomResultEvent,RoomLikeRoomComposer}from'@nitrots/nitro-renderer';import classNames from'classnames';import{useCallback,useEffect,useState}from'react';import{CreateLinkEvent,GetRoomEngine,LocalizeText,SendMessageComposer}from'../../../../api';import{Base,Column,Flex,Text,TransitionAnimation,TransitionAnimationTypes}from'../../../../common';import{UseMessageEventHook,useSharedNavigatorData}from'../../../../hooks';import{useRoomContext}from'../../RoomContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const RoomToolsWidgetView=props=>{const[isZoomedIn,setIsZoomedIn]=useState(false);const[roomName,setRoomName]=useState(null);const[roomOwner,setRoomOwner]=useState(null);const[roomTags,setRoomTags]=useState(null);const[roomInfoDisplay,setRoomInfoDisplay]=useState(false);const[isOpen,setIsOpen]=useState(false);const[navigatorData,setNavigatorData]=useSharedNavigatorData();const{roomSession=null,widgetHandler=null}=useRoomContext();const[show,setShow]=useState(true);const handleToolClick=action=>{switch(action){case'settings':CreateLinkEvent('navigator/toggle-room-info');return;case'zoom':setIsZoomedIn(prevValue=>{let scale=GetRoomEngine().getRoomInstanceRenderingCanvasScale(roomSession.roomId,1);if(!prevValue)scale/=2;else scale*=2;GetRoomEngine().setRoomInstanceRenderingCanvasScale(roomSession.roomId,1,scale);return!prevValue;});return;case'chat_history':CreateLinkEvent('chat-history/toggle');return;case'like_room':SendMessageComposer(new RoomLikeRoomComposer(1));return;case'toggle_room_link':CreateLinkEvent('navigator/toggle-room-link');return;}};const onGetGuestRoomResultEvent=useCallback(event=>{const parser=event.getParser();if(!parser.roomEnter)return;if(roomName!==parser.data.roomName)setRoomName(parser.data.roomName);if(roomOwner!==parser.data.ownerName)setRoomOwner(parser.data.ownerName);if(roomTags!==parser.data.tags)setRoomTags(parser.data.tags);},[roomName,roomOwner,roomTags]);UseMessageEventHook(GetGuestRoomResultEvent,onGetGuestRoomResultEvent);useEffect(()=>{setIsOpen(true);const timeout=setTimeout(()=>setIsOpen(false),5000);return()=>clearTimeout(timeout);},[roomName,roomOwner,roomTags]);return/*#__PURE__*/_jsxs(Flex,{gap:2,className:\"nitro-room-tools-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"btn-toggle toggle-roomtool d-flex align-items-center\",onClick:()=>setShow(!show),children:/*#__PURE__*/_jsx(\"div\",{className:'toggle-icon '+classNames({'right':!show,'left':show})})}),show&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Flex,{gap:0,center:true,className:\"nitro-room-tools p-3 px-3\",children:[/*#__PURE__*/_jsxs(Column,{center:true,className:\"p-1\",children:[/*#__PURE__*/_jsx(Base,{pointer:true,title:LocalizeText('room.settings.button.text'),className:\"icon icon-cog\",onClick:()=>handleToolClick('settings')}),/*#__PURE__*/_jsx(Base,{pointer:true,title:LocalizeText('room.zoom.button.text'),onClick:()=>handleToolClick('zoom'),className:'icon '+classNames({'icon-zoom-less':!isZoomedIn,'icon-zoom-more':isZoomedIn})}),/*#__PURE__*/_jsx(Base,{pointer:true,title:LocalizeText('room.chathistory.button.text'),onClick:()=>handleToolClick('chat_history'),className:\"icon icon-chat-history\"}),navigatorData.canRate&&/*#__PURE__*/_jsx(Base,{pointer:true,title:LocalizeText('room.like.button.text'),onClick:()=>handleToolClick('like_room'),className:\"icon icon-like-room\"}),/*#__PURE__*/_jsx(Base,{pointer:true,title:LocalizeText('room.like.button.text'),onClick:()=>handleToolClick('toggle_room_link'),className:\"icon icon-link-room\"})]}),/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(Flex,{className:\"w-100 room-tool-item\",children:/*#__PURE__*/_jsx(Text,{underline:true,small:true,onClick:()=>handleToolClick('settings'),children:LocalizeText('room.settings.button.text')})}),/*#__PURE__*/_jsx(Flex,{className:\"w-100 room-tool-item\",children:/*#__PURE__*/_jsx(Text,{underline:true,small:true,onClick:()=>handleToolClick('zoom'),children:LocalizeText('room.zoom.button.text')})}),/*#__PURE__*/_jsx(Flex,{className:\"w-100 room-tool-item\",children:/*#__PURE__*/_jsx(Text,{underline:true,small:true,onClick:()=>handleToolClick('chat_history'),children:LocalizeText('room.chathistory.button.text')})}),navigatorData.canRate&&/*#__PURE__*/_jsx(Flex,{className:\"w-100 room-tool-item\",children:/*#__PURE__*/_jsx(Text,{underline:true,small:true,onClick:()=>handleToolClick('like_room'),children:LocalizeText('room.like.button.text')})}),/*#__PURE__*/_jsx(Flex,{className:\"w-100 room-tool-item\",children:/*#__PURE__*/_jsx(Text,{underline:true,small:true,onClick:()=>handleToolClick('toggle_room_link'),children:LocalizeText('navigator.embed.caption')})})]})]}),/*#__PURE__*/_jsx(Column,{justifyContent:\"center\",children:/*#__PURE__*/_jsx(TransitionAnimation,{type:TransitionAnimationTypes.SLIDE_LEFT,inProp:isOpen,timeout:300,children:/*#__PURE__*/_jsx(Column,{center:true,gap:2,children:/*#__PURE__*/_jsxs(Column,{className:\"nitro-room-tools-info py-2 px-3\",children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{wrap:true,variant:\"white\",fontSize:4,children:roomName}),/*#__PURE__*/_jsx(Text,{variant:\"muted\",fontSize:5,children:roomOwner})]}),roomTags&&roomTags.length>0&&/*#__PURE__*/_jsx(Flex,{gap:2,children:roomTags.map((tag,index)=>/*#__PURE__*/_jsxs(Text,{small:true,variant:\"white\",className:\"rounded bg-primary p-1\",children:[\"#\",tag]},index))})]})})})})]})]});};","map":null,"metadata":{},"sourceType":"module"}