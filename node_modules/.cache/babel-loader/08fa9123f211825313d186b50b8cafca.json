{"ast":null,"code":"import{BadgePointLimitsEvent,RoomEngineObjectEvent,RoomPreviewer,RoomSessionEvent}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{AddEventLinkTracker,GetLocalization,GetRoomEngine,LocalizeText,RemoveLinkEventTracker,UnseenItemCategory}from'../../api';import{isObjectMoverRequested,setObjectMoverRequested}from'../../api/inventory/InventoryUtilities';import{NitroCardContentView,NitroCardHeaderView,NitroCardTabsItemView,NitroCardTabsView,NitroCardView}from'../../common';import{useInventoryTrade,useInventoryUnseenTracker,UseMessageEventHook,UseRoomEngineEvent,UseRoomSessionManagerEvent}from'../../hooks';import{InventoryBadgeView}from'./views/badge/InventoryBadgeView';import{InventoryBotView}from'./views/bot/InventoryBotView';import{InventoryFurnitureView}from'./views/furniture/InventoryFurnitureView';import{InventoryTradeView}from'./views/furniture/InventoryTradeView';import{InventoryPetView}from'./views/pet/InventoryPetView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const TAB_FURNITURE='inventory.furni';const TAB_BOTS='inventory.bots';const TAB_PETS='inventory.furni.tab.pets';const TAB_BADGES='inventory.badges';const TABS=[TAB_FURNITURE,TAB_BOTS,TAB_PETS,TAB_BADGES];const UNSEEN_CATEGORIES=[UnseenItemCategory.FURNI,UnseenItemCategory.BOT,UnseenItemCategory.PET,UnseenItemCategory.BADGE];export const InventoryView=props=>{const[isVisible,setIsVisible]=useState(false);const[currentTab,setCurrentTab]=useState(TABS[0]);const[roomSession,setRoomSession]=useState(null);const[roomPreviewer,setRoomPreviewer]=useState(null);const{isTrading=false,stopTrading=null}=useInventoryTrade();const{getCount=null,resetCategory=null}=useInventoryUnseenTracker();const close=()=>{if(isTrading)stopTrading();setIsVisible(false);};const onRoomEngineObjectPlacedEvent=useCallback(event=>{if(!isObjectMoverRequested())return;setObjectMoverRequested(false);if(!event.placedInRoom)setIsVisible(true);},[]);UseRoomEngineEvent(RoomEngineObjectEvent.PLACED,onRoomEngineObjectPlacedEvent);const onRoomSessionEvent=useCallback(event=>{switch(event.type){case RoomSessionEvent.CREATED:setRoomSession(event.session);return;case RoomSessionEvent.ENDED:setRoomSession(null);setIsVisible(false);return;}},[]);UseRoomSessionManagerEvent(RoomSessionEvent.CREATED,onRoomSessionEvent);UseRoomSessionManagerEvent(RoomSessionEvent.ENDED,onRoomSessionEvent);const onBadgePointLimitsEvent=useCallback(event=>{const parser=event.getParser();for(const data of parser.data)GetLocalization().setBadgePointLimit(data.badgeId,data.limit);},[]);UseMessageEventHook(BadgePointLimitsEvent,onBadgePointLimitsEvent);useEffect(()=>{const linkTracker={linkReceived:url=>{const parts=url.split('/');if(parts.length<2)return;switch(parts[1]){case'show':setIsVisible(true);return;case'hide':setIsVisible(false);return;case'toggle':setIsVisible(prevValue=>!prevValue);return;}},eventUrlPrefix:'inventory/'};AddEventLinkTracker(linkTracker);return()=>RemoveLinkEventTracker(linkTracker);},[]);useEffect(()=>{setRoomPreviewer(new RoomPreviewer(GetRoomEngine(),++RoomPreviewer.PREVIEW_COUNTER));return()=>{setRoomPreviewer(prevValue=>{prevValue.dispose();return null;});};},[]);useEffect(()=>{if(!isVisible&&isTrading)setIsVisible(true);},[isVisible,isTrading]);if(!isVisible)return null;return/*#__PURE__*/_jsxs(NitroCardView,{uniqueKey:'inventory',className:isTrading?'nitro-inventory trading':'nitro-inventory',theme:isTrading?'primary':'',children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('inventory.title'),onCloseClick:close}),!isTrading&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NitroCardTabsView,{children:TABS.map((name,index)=>{return/*#__PURE__*/_jsx(NitroCardTabsItemView,{isActive:currentTab===name,onClick:event=>setCurrentTab(name),count:getCount(UNSEEN_CATEGORIES[index]),children:LocalizeText(name)},index);})}),/*#__PURE__*/_jsxs(NitroCardContentView,{children:[currentTab===TAB_FURNITURE&&/*#__PURE__*/_jsx(InventoryFurnitureView,{roomSession:roomSession,roomPreviewer:roomPreviewer}),currentTab===TAB_BOTS&&/*#__PURE__*/_jsx(InventoryBotView,{roomSession:roomSession,roomPreviewer:roomPreviewer}),currentTab===TAB_PETS&&/*#__PURE__*/_jsx(InventoryPetView,{roomSession:roomSession,roomPreviewer:roomPreviewer}),currentTab===TAB_BADGES&&/*#__PURE__*/_jsx(InventoryBadgeView,{})]})]}),isTrading&&/*#__PURE__*/_jsx(NitroCardContentView,{children:/*#__PURE__*/_jsx(InventoryTradeView,{cancelTrade:close})})]});};","map":null,"metadata":{},"sourceType":"module"}