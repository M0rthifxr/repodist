{"ast":null,"code":"import{NitroSettingsEvent,UserSettingsCameraFollowComposer,UserSettingsEvent,UserSettingsOldChatComposer,UserSettingsRoomInvitesComposer,UserSettingsSoundComposer}from'@nitrots/nitro-renderer';import{useCallback,useEffect,useState}from'react';import{AddEventLinkTracker,LocalizeText,RemoveLinkEventTracker,SendMessageComposer}from'../../api';import{Button,Column,Flex,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../common';import{DispatchMainEvent,DispatchUiEvent,useCatalogPlaceMultipleItems,useCatalogSkipPurchaseConfirmation,UseMessageEventHook}from'../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const UserSettingsView=props=>{const[isVisible,setIsVisible]=useState(false);const[userSettings,setUserSettings]=useState(null);const[catalogPlaceMultipleObjects,setCatalogPlaceMultipleObjects]=useCatalogPlaceMultipleItems();const[catalogSkipPurchaseConfirmation,setCatalogSkipPurchaseConfirmation]=useCatalogSkipPurchaseConfirmation();const onUserSettingsEvent=useCallback(event=>{const parser=event.getParser();const settingsEvent=new NitroSettingsEvent();settingsEvent.volumeSystem=parser.volumeSystem;settingsEvent.volumeFurni=parser.volumeFurni;settingsEvent.volumeTrax=parser.volumeTrax;settingsEvent.oldChat=parser.oldChat;settingsEvent.roomInvites=parser.roomInvites;settingsEvent.cameraFollow=parser.cameraFollow;settingsEvent.flags=parser.flags;settingsEvent.chatType=parser.chatType;setUserSettings(settingsEvent);DispatchMainEvent(settingsEvent);},[]);UseMessageEventHook(UserSettingsEvent,onUserSettingsEvent);const processAction=useCallback((type,value)=>{let doUpdate=true;const clone=userSettings.clone();switch(type){case'close_view':setIsVisible(false);doUpdate=false;return;case'oldchat':clone.oldChat=value;SendMessageComposer(new UserSettingsOldChatComposer(clone.oldChat));break;case'room_invites':clone.roomInvites=value;SendMessageComposer(new UserSettingsRoomInvitesComposer(clone.roomInvites));break;case'camera_follow':clone.cameraFollow=value;SendMessageComposer(new UserSettingsCameraFollowComposer(clone.cameraFollow));break;case'system_volume':clone.volumeSystem=value;clone.volumeSystem=Math.max(0,clone.volumeSystem);clone.volumeSystem=Math.min(100,clone.volumeSystem);break;case'furni_volume':clone.volumeFurni=value;clone.volumeFurni=Math.max(0,clone.volumeFurni);clone.volumeFurni=Math.min(100,clone.volumeFurni);break;case'trax_volume':clone.volumeTrax=value;clone.volumeTrax=Math.max(0,clone.volumeTrax);clone.volumeTrax=Math.min(100,clone.volumeTrax);break;}if(doUpdate)setUserSettings(clone);DispatchMainEvent(clone);},[userSettings]);const saveRangeSlider=useCallback(type=>{switch(type){case'volume':SendMessageComposer(new UserSettingsSoundComposer(Math.round(userSettings.volumeSystem),Math.round(userSettings.volumeFurni),Math.round(userSettings.volumeTrax)));break;}},[userSettings]);useEffect(()=>{const linkTracker={linkReceived:url=>{const parts=url.split('/');if(parts.length<2)return;switch(parts[1]){case'show':setIsVisible(true);return;case'hide':setIsVisible(false);return;case'toggle':setIsVisible(prevValue=>!prevValue);return;}},eventUrlPrefix:'user-settings/'};AddEventLinkTracker(linkTracker);return()=>RemoveLinkEventTracker(linkTracker);},[]);useEffect(()=>{if(!userSettings)return;DispatchUiEvent(userSettings);},[userSettings]);if(!isVisible)return null;return/*#__PURE__*/_jsxs(NitroCardView,{uniqueKey:\"user-settings\",className:\"user-settings-window\",theme:\"settings\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:LocalizeText('widget.memenu.settings.title'),onCloseClick:event=>processAction('close_view')}),/*#__PURE__*/_jsxs(NitroCardContentView,{gap:3,className:\"text-white\",children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"flash-form-check-input\",type:\"checkbox\",checked:userSettings.oldChat,onChange:event=>processAction('oldchat',event.target.checked)}),/*#__PURE__*/_jsx(Text,{children:LocalizeText('memenu.settings.chat.prefer.old.chat')})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"flash-form-check-input\",type:\"checkbox\",checked:userSettings.roomInvites,onChange:event=>processAction('room_invites',event.target.checked)}),/*#__PURE__*/_jsx(Text,{children:LocalizeText('memenu.settings.other.ignore.room.invites')})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"flash-form-check-input\",type:\"checkbox\",checked:userSettings.cameraFollow,onChange:event=>processAction('camera_follow',event.target.checked)}),/*#__PURE__*/_jsx(Text,{children:LocalizeText('memenu.settings.other.disable.room.camera.follow')})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"flash-form-check-input\",type:\"checkbox\",checked:catalogPlaceMultipleObjects,onChange:event=>setCatalogPlaceMultipleObjects(event.target.checked)}),/*#__PURE__*/_jsx(Text,{children:LocalizeText('memenu.settings.other.place.multiple.objects')})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"flash-form-check-input\",type:\"checkbox\",checked:catalogSkipPurchaseConfirmation,onChange:event=>setCatalogSkipPurchaseConfirmation(event.target.checked)}),/*#__PURE__*/_jsx(Text,{children:LocalizeText('memenu.settings.other.skip.purchase.confirmation')})]})]}),/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsx(Text,{center:true,children:LocalizeText('widget.memenu.settings.volume')}),/*#__PURE__*/_jsxs(Flex,{gap:2,children:[/*#__PURE__*/_jsx(Text,{className:\"w-25\",children:LocalizeText('widget.memenu.settings.volume.ui')}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"i\",{className:userSettings.volumeSystem>1?'icon icon-sound-off':'icon icon-sound-off-active'}),/*#__PURE__*/_jsxs(Column,{gap:0,children:[/*#__PURE__*/_jsx(Flex,{className:\"number-range\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",className:\"custom-range\",min:\"0\",max:\"100\",step:\"1\",id:\"volumeSystem\",value:userSettings.volumeSystem,onChange:event=>processAction('system_volume',event.target.value),onMouseUp:()=>saveRangeSlider('volume')})]}),/*#__PURE__*/_jsx(\"i\",{className:userSettings.volumeSystem<1?'icon icon-sound-on':'icon icon-sound-on-active'})]})]}),/*#__PURE__*/_jsxs(Flex,{gap:2,children:[/*#__PURE__*/_jsx(Text,{className:\"w-25\",children:LocalizeText('widget.memenu.settings.volume.furni')}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"i\",{className:userSettings.volumeFurni>1?'icon icon-sound-off':'icon icon-sound-off-active'}),/*#__PURE__*/_jsxs(Column,{gap:0,children:[/*#__PURE__*/_jsx(Flex,{className:\"number-range\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",className:\"custom-range\",min:\"0\",max:\"100\",step:\"1\",id:\"volumeFurni\",value:userSettings.volumeFurni,onChange:event=>processAction('furni_volume',event.target.value),onMouseUp:()=>saveRangeSlider('volume')})]}),/*#__PURE__*/_jsx(\"i\",{className:userSettings.volumeFurni<1?'icon icon-sound-on':'icon icon-sound-on-active'})]})]}),/*#__PURE__*/_jsxs(Flex,{gap:2,children:[/*#__PURE__*/_jsx(Text,{className:\"w-25\",children:LocalizeText('widget.memenu.settings.volume.trax')}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"i\",{className:userSettings.volumeTrax>1?'icon icon-sound-off':'icon icon-sound-off-active'}),/*#__PURE__*/_jsxs(Column,{gap:0,children:[/*#__PURE__*/_jsx(Flex,{className:\"number-range\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",className:\"custom-range\",min:\"0\",max:\"100\",step:\"1\",id:\"volumeTrax\",value:userSettings.volumeTrax,onChange:event=>processAction('trax_volume',event.target.value),onMouseUp:()=>saveRangeSlider('volume')})]}),/*#__PURE__*/_jsx(\"i\",{className:userSettings.volumeTrax<1?'icon icon-sound-on':'icon icon-sound-on-active'})]})]})]}),/*#__PURE__*/_jsx(Flex,{alignItems:\"end\",children:/*#__PURE__*/_jsx(Button,{onClick:event=>processAction('close_view'),children:LocalizeText('generic.back')})})]})]});};","map":null,"metadata":{},"sourceType":"module"}